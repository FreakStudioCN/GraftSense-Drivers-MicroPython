# NE555 超声波雾化器驱动 - MicroPython版本

## 目录
- [简介](#简介)
- [主要功能](#主要功能)
- [硬件要求](#硬件要求)
- [文件说明](#文件说明)
- [软件设计核心思想](#软件设计核心思想)
- [使用说明](#使用说明)
- [示例程序](#示例程序)
- [注意事项](#注意事项)
- [联系方式](#联系方式)
- [许可协议](#许可协议)

---

## 简介
基于NE555芯片的雾化器模块是一种将电能转化为超声波振动，将液体雾化成细微雾气的设备。其结构简单、成本低廉、控制方便，广泛应用于加湿器、香薰机、消毒设备等场景。

> **注意**：不能应用于高精度或安全关键的场景。

本项目提供基于MicroPython的驱动代码及示例程序，方便开发者快速接入NE555超声波雾化器模块，实现雾化控制功能。

---

## 主要功能
- **GPIO控制**：通过GPIO引脚高低电平实现雾化器开关控制
- **操作简便**：提供直观接口（开启/关闭/切换），便于集成
- **状态监测**：可查询雾化器当前工作状态
- **跨平台支持**：兼容多种硬件平台（树莓派Pico等MicroPython兼容开发板）

---

## 硬件要求
### 推荐测试硬件
- 树莓派 Pico/Pico W
- 基于NE555的雾化器模块
- 杜邦线若干
- （可选）外接电源（用于大功率雾化器模块）

### 模块引脚说明
| NE555雾化器引脚 | 功能描述 |
|-----------------|----------|
| VCC             | 电源正极（根据模块而定，通常为5V） |
| GND             | 电源负极 |
| IN              | 控制信号输入引脚（接GPIO） |

---

## 文件说明
### atomization.py
实现NE555雾化器模块的驱动，核心类`Atomization`提供控制接口，各方法作用如下：
- `__init__(self, pin: int)`：初始化雾化模块对象，参数`pin`为控制雾化器开关的GPIO引脚编号；初始化时会自动关闭雾化器，仅支持可配置为输出模式的GPIO。
- `on(self) -> None`：打开雾化模块（输出高电平），会更新内部状态为True，非ISR-safe。
- `off(self) -> None`：关闭雾化模块（输出低电平），会更新内部状态为False，非ISR-safe。
- `toggle(self) -> None`：切换雾化模块状态（开->关或关->开），内部会调用on()或off()，非ISR-safe。
- `is_on(self) -> bool`：返回当前雾化模块状态，True表示开启，False表示关闭；仅返回内部状态，不直接读取引脚电平，查询操作是安全的。

### main.py
示例主程序，初始化雾化器并循环进行开关控制测试：
- 导入必要模块并设置初始化延时
- 创建`Atomization`实例（默认使用GPIO2）
- 主循环中依次测试开启、关闭、切换状态功能
- 支持键盘中断（Ctrl+C）终止程序并打印结束信息

---

## 软件设计核心思想
### 简洁控制逻辑
- 采用GPIO数字输出控制雾化器开关
- 高电平开启雾化器，低电平关闭雾化器
- 维护内部状态变量，跟踪工作状态

### 直观接口设计
- 提供`on()`、`off()`、`toggle()`方法满足基本控制需求
- `is_on()`方法用于状态查询，方便业务逻辑判断

### 硬件抽象
- 通过`machine.Pin`接口屏蔽底层硬件差异
- 驱动仅关注逻辑控制，硬件初始化由应用层处理

---

## 使用说明
### 硬件接线（树莓派Pico示例）

| NE555雾化器引脚 | Pico GPIO引脚 |
|-----------------|---------------|
| VCC             | 5V            |
| GND             | GND           |
| IN              | GP2           |

> **注意**：
> - 确保**VCC**和**GND**接线正确
> - `IN`引脚连接开发板的GPIO输出引脚
> - 大功率雾化器模块需外接电源，不要直接使用开发板供电

---

### 软件依赖
- **固件版本**：MicroPython v1.23+
- **内置库**：
  - `machine`（用于GPIO控制）
  - `time`（用于延时）
- **开发工具**：推荐PyCharm或Thonny

---

### 安装步骤
1. 向树莓派Pico烧录**MicroPython固件**
2. 将`atomization.py`和`main.py`上传到Pico
3. 根据硬件连接修改`main.py`中的引脚配置
4. 在开发工具中运行`main.py`开始测试

---

## 示例程序
```python
# Python env   : MicroPython v1.23.0
# -*- coding: utf-8 -*-
# @Time    : 2025/9/9 上午10:20
# @Author  : 缪贵成
# @File    : main.py
# @Description :基于NE555芯片的雾化模块驱动

# ======================================== 导入相关模块 =========================================

import time
from ne555_atomization import Atomization

# ======================================== 全局变量 ============================================

# ======================================== 功能函数 ============================================

# ======================================== 自定义类 ============================================

# ======================================== 初始化配置 ===========================================

time.sleep(3)
print("FreakStudio:Testing the NE555-based atomization module")
# 假设 GPIO2 控制雾化模块
atomizer = Atomization(pin=2)

# ========================================  主程序  ============================================

try:
    while True:
        print("turn on")
        atomizer.on()
        print("status:", atomizer.is_on())
        time.sleep(3)

        print("turn off...")
        atomizer.off()
        print("status:", atomizer.is_on())
        time.sleep(3)

        print("toggle...")
        atomizer.toggle()
        print("status:", atomizer.is_on())
        time.sleep(3)

except KeyboardInterrupt:
    print("test stop")

```
---
## 注意事项
### 供电要求
- 雾化器模块工作电压通常为5V
- 确保电源供应稳定，避免电压波动
- 大功率模块必须外接电源，防止损坏开发板

### 控制注意事项
- 本驱动仅提供简单的开关控制，不支持雾量调节
- 控制引脚应设置为输出模式
- 频繁切换可能会缩短雾化器使用寿命

### 使用环境
- 避免在易燃易爆环境中使用
- 保持雾化器表面清洁，防止水垢堆积
- 工作时确保有足够液体，避免干烧

### 软件注意事项
- GPIO 操作不是 ISR-safe，不要在中断服务程序中调用
- 内部状态与操作同步，不读取实际引脚电平
- 切换操作之间建议添加 1 秒以上的延时
---
## 联系方式
如有任何问题或需要帮助，请通过以下方式联系开发者：  
📧 邮箱：10696531183@qq.com  
💻 GitHub：https://github.com/FreakStudioCN
---
## 许可协议
本项目中，除 `machine` 等 MicroPython 官方模块（MIT 许可证）外，所有由作者编写的驱动与扩展代码均采用 **知识共享署名-非商业性使用 4.0 国际版 (CC BY-NC 4.0)** 许可协议发布。  

您可以自由地：  
- **共享** — 在任何媒介以任何形式复制、发行本作品  
- **演绎** — 修改、转换或以本作品为基础进行创作  

惟须遵守下列条件：  
- **署名** — 您必须给出适当的署名，提供指向本许可协议的链接，同时标明是否（对原始作品）作了修改。您可以用任何合理的方式来署名，但是不得以任何方式暗示许可人为您或您的使用背书。  
- **非商业性使用** — 您不得将本作品用于商业目的。  
- **合理引用方式** — 可在代码注释、文档、演示视频或项目说明中明确来源。  

**版权归 FreakStudio 所有。**