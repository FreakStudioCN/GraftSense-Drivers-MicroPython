# åŸºäºŽPCF8574èŠ¯ç‰‡çš„å…«æ®µå…‰æ¡æ•°ç ç®¡æ¨¡å—æµ‹è¯•ç¨‹åº - MicroPythonç‰ˆæœ¬
## ç›®å½•
- [ç®€ä»‹](#ç®€ä»‹)
- [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
- [ç¡¬ä»¶è¦æ±‚](#ç¡¬ä»¶è¦æ±‚)
- [æ–‡ä»¶è¯´æ˜Ž](#æ–‡ä»¶è¯´æ˜Ž)
- [è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³](#è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³)
- [ä½¿ç”¨è¯´æ˜Ž](#ä½¿ç”¨è¯´æ˜Ž)
- [ç¤ºä¾‹ç¨‹åº](#ç¤ºä¾‹ç¨‹åº)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
- [è”ç³»æ–¹å¼](#è”ç³»æ–¹å¼)
- [è®¸å¯åè®®](#è®¸å¯åè®®)
---
## ç®€ä»‹
PCF8574 æ˜¯ä¸€æ¬¾ I2C æŽ¥å£çš„ GPIO æ‰©å±•èŠ¯ç‰‡ï¼Œå¯é€šè¿‡ 2 æ ¹ I2C å¼•è„šæ‰©å±• 8 è·¯ GPIO å£ï¼Œå¹¿æ³›ç”¨äºŽèµ„æºå—é™çš„åµŒå…¥å¼ç³»ç»Ÿä¸­æ‰©å±•å¤–è®¾æŽ¥å£ã€‚æœ¬é¡¹ç›®åŸºäºŽ PCF8574 èŠ¯ç‰‡å®žçŽ°å…«æ®µå…‰æ¡æ•°ç ç®¡æŽ§åˆ¶

> **æ³¨æ„**ï¼šè¯¥ç¨‹åºä»…é€‚ç”¨äºŽåŸºäºŽ PCF8574 èŠ¯ç‰‡çš„å…«æ®µå…‰æ¡ledæŽ§åˆ¶æ–¹æ¡ˆï¼Œä¸æ”¯æŒå…¶ä»–åž‹å· GPIO æ‰©å±•èŠ¯ç‰‡ï¼›
æœ¬é¡¹ç›®æä¾›åŸºäºŽ MicroPython çš„é©±åŠ¨ä»£ç ï¼ˆ`pcf8574.py`ã€`led_bar.py`ï¼‰åŠæµ‹è¯•ä¸»ç¨‹åºï¼ˆ`main.py`ï¼‰ï¼Œæ–¹ä¾¿å¼€å‘è€…å¿«é€ŸæŽ¥å…¥åŸºäºŽPCF8574èŠ¯ç‰‡çš„å…«æ®µå…‰æ¡æ•°ç ç®¡æ¨¡å—ï¼Œå®žçŽ°ç¨³å®šçš„ledæŽ§åˆ¶åŠŸèƒ½ã€‚
---
## ä¸»è¦åŠŸèƒ½
- **I2C æŽ¥å£æ‰©å±•**ï¼šé€šè¿‡ PCF8574 èŠ¯ç‰‡å°† I2C æ€»çº¿æ‰©å±•ä¸º GPIO å£ï¼Œå®žçŽ°å…«æ®µledæŽ§åˆ¶
- **çµæ´»çš„å¼•è„šæ˜ å°„**ï¼šæ”¯æŒè‡ªå®šä¹‰æŒ‰é”®ä¸Ž PCF8574 å¼•è„šçš„æ˜ å°„å…³ç³»ï¼Œé€‚é…ä¸åŒç¡¬ä»¶æŽ¥çº¿
- **è·¨å¹³å°å…¼å®¹**ï¼šä»…ä¾èµ– MicroPython æ ‡å‡†åº“ï¼Œå…¼å®¹ ESP32ã€ESP8266ã€æ ‘èŽ“æ´¾ Pico ç­‰å¼€å‘æ¿
- **èµ„æºé‡Šæ”¾ä¼˜åŒ–**ï¼šç¨‹åºç»ˆæ­¢æ—¶è‡ªåŠ¨é‡Šæ”¾ I2C æ€»çº¿èµ„æºï¼Œé¿å…ç¡¬ä»¶å ç”¨å†²çª
---
## ç¡¬ä»¶è¦æ±‚
### æŽ¨èæµ‹è¯•ç¡¬ä»¶
- MicroPython å…¼å®¹å¼€å‘æ¿ï¼ˆESP32/ESP8266/æ ‘èŽ“æ´¾ Picoï¼‰
- å…«æ®µå…‰æ¡æ•°ç ç®¡æ¨¡å—
- æœé‚¦çº¿è‹¥å¹²ï¼ˆè‡³å°‘ 4 æ ¹ï¼šVCCã€GNDã€SCLã€SDAï¼‰
- ï¼ˆå¯é€‰ï¼‰é¢åŒ…æ¿ï¼ˆä¾¿äºŽä¸´æ—¶æŽ¥çº¿æµ‹è¯•ï¼‰

### æ¨¡å—å¼•è„šè¯´æ˜Ž
| PCF8574 å¼•è„š | åŠŸèƒ½æè¿° | ç”µæ°”ç‰¹æ€§ |
|--------------|----------|----------|
| VCC          | ç”µæºæ­£æž | 3.3V-5Vï¼ˆå®½ç”µåŽ‹å…¼å®¹ï¼‰ |
| GND          | ç”µæºè´Ÿæž | æŽ¥åœ°ï¼Œéœ€ä¸Žå¼€å‘æ¿å…±åœ° |
| SCL          | I2C æ—¶é’Ÿçº¿ | å•å‘æ—¶é’Ÿè¾“å…¥ï¼Œéœ€æŽ¥å¼€å‘æ¿å¯¹åº” I2C SCL å¼•è„š |
| SDA          | I2C æ•°æ®çº¿ | åŒå‘æ•°æ®ä¼ è¾“ï¼Œéœ€æŽ¥å¼€å‘æ¿å¯¹åº” I2C SDA å¼•è„š |
---
## æ–‡ä»¶è¯´æ˜Ž
### 1. pcf8574.py
æ ¸å¿ƒç±»ä¸º `PCF8574`ï¼Œç”¨äºŽå®žçŽ° PCF8574 èŠ¯ç‰‡çš„ I2C é€šä¿¡ä¸Ž GPIO æŽ§åˆ¶ï¼Œå„æ–¹æ³•ä½œç”¨å¦‚ä¸‹ï¼š
- `__init__(self, i2c, address=0x20)`ï¼šåˆå§‹åŒ– PCF8574 å®žä¾‹ï¼Œå»ºç«‹ä¸ŽèŠ¯ç‰‡çš„ I2C é€šä¿¡è¿žæŽ¥ï¼›å‚æ•° `i2c` ä¸ºåº”ç”¨å±‚å·²åˆå§‹åŒ–çš„ I2C å®žä¾‹ï¼Œ`address` ä¸ºèŠ¯ç‰‡çš„ I2C åœ°å€ï¼ˆé»˜è®¤ 0x20ï¼Œå¯é€šè¿‡èŠ¯ç‰‡ A0/A1/A2 å¼•è„šè°ƒæ•´ï¼‰ã€‚
- `read(self) -> int`ï¼šè¯»å– 8 è·¯ GPIO å£çš„å½“å‰æ•´ä½“çŠ¶æ€ï¼Œè¿”å›ž 1 å­—èŠ‚æ•´æ•°ï¼›æ•´æ•°çš„æ¯ä¸€ä½å¯¹åº” 1 è·¯å¼•è„šï¼Œ1 è¡¨ç¤ºé«˜ç”µå¹³ï¼Œ0 è¡¨ç¤ºä½Žç”µå¹³ã€‚
- `write(self, value)`ï¼šå‘ 8 è·¯ GPIO å£å†™å…¥æŽ§åˆ¶æ•°æ®ï¼Œè®¾ç½®è¾“å‡ºçŠ¶æ€ï¼›å‚æ•° `value` ä¸º 1 å­—èŠ‚æ•´æ•°ï¼Œæ¯ä¸€ä½å¯¹åº” 1 è·¯å¼•è„šçš„è¾“å‡ºç”µå¹³ï¼ˆ1 é«˜ç”µå¹³ï¼Œ0 ä½Žç”µå¹³ï¼‰ã€‚
- `set_pin(self, pin, value)`ï¼šå•ç‹¬æŽ§åˆ¶æŸä¸€è·¯ GPIO å£çš„è¾“å‡ºçŠ¶æ€ï¼›å‚æ•° `pin` ä¸ºå¼•è„šç¼–å·ï¼ˆ0-7ï¼‰ï¼Œ`value` ä¸ºè¾“å‡ºç”µå¹³ï¼ˆTrue é«˜ç”µå¹³ï¼ŒFalse ä½Žç”µå¹³ï¼‰ã€‚
- `get_pin(self, pin) -> bool`ï¼šå•ç‹¬è¯»å–æŸä¸€è·¯ GPIO å£çš„è¾“å…¥çŠ¶æ€ï¼›å‚æ•° `pin` ä¸ºå¼•è„šç¼–å·ï¼ˆ0-7ï¼‰ï¼Œè¿”å›žå¸ƒå°”å€¼ï¼ˆTrue é«˜ç”µå¹³ï¼ŒFalse ä½Žç”µå¹³ï¼‰ã€‚

### 2. led_bar.py
æ ¸å¿ƒç±»ä¸º `LEDBar`ï¼ŒåŸºäºŽé€šè¿‡ PCF8574 æŽ§åˆ¶ 8 æ®µå…‰æ¡ï¼ˆ8 ä¸ª LEDï¼‰ï¼Œæä¾›å•ç¯æŽ§åˆ¶ã€ä¸€æ¬¡æ€§å†™å…¥å’ŒæŒ‰çº§åˆ«ç‚¹äº®ç­‰å¸¸ç”¨æ–¹æ³•ï¼Œå„æ–¹æ³•ä½œç”¨å¦‚ä¸‹ï¼š
- `__init__(pcf8574)`ï¼šæž„é€ å‡½æ•°ï¼ŒéªŒè¯ pcf8574 å¿…é¡»å®žçŽ° `check`ã€`pin`ã€`toggle` ç­‰æ–¹æ³•ï¼Œåˆå§‹åŒ–æ—¶ä¼šè°ƒç”¨ `clear()` æ¸…é™¤æ‰€æœ‰ LEDã€‚
- `set_led(index, value)`ï¼šè®¾ç½®å•ä¸ª LEDï¼ˆ`index` 0~7ï¼‰ï¼Œ`value` ä¸º `True`ï¼ˆç‚¹äº®ï¼‰æˆ– `False`ï¼ˆç†„ç­ï¼‰ï¼›ç´¢å¼•è¶Šç•Œä¼šæŠ›å‡º `ValueError`ã€‚
- `set_all(value) `ï¼šä¸€æ¬¡å†™å…¥ 8 ä½çŠ¶æ€ï¼Œ `value ` ä¸º 0~255 çš„æ•´æ•°ï¼Œä¼šæŠŠå€¼èµ‹ç»™  `pcf.port `ï¼›è¶…å‡ºèŒƒå›´æŠ›å‡º  `ValueError `ã€‚
- `clear() `ï¼šç†„ç­æ‰€æœ‰ LEDï¼ˆç­‰åŒäºŽ  `set_all(0x00)`ï¼‰ã€‚

### 3. main.py
æ— è‡ªå®šä¹‰ç±»ï¼Œä¸ºæµ‹è¯•ä¸»ç¨‹åºï¼Œæ ¸å¿ƒé€»è¾‘é€šè¿‡å‡½æ•°è°ƒç”¨å®žçŽ°ï¼š
- åˆå§‹åŒ– I2C æ€»çº¿ï¼šé…ç½® I2C å¼•è„šï¼ˆé»˜è®¤ SCL=GPIO5ã€SDA=GPIO4ï¼‰ä¸Žé€šä¿¡é¢‘çŽ‡ï¼Œåˆ›å»º I2C å®žä¾‹ã€‚
- å®žä¾‹åŒ–ç¡¬ä»¶ç±»ï¼šåˆ›å»º `PCF8574` å®žä¾‹ï¼ˆæŒ‡å®š I2C åœ°å€ 0x20ï¼‰å’Œ `LEDBar` å®žä¾‹ï¼ˆå¼•è„šæ˜ å°„ï¼‰ã€‚
- ä¸»å¾ªçŽ¯é€»è¾‘ï¼šé¡ºåºæ¼”ç¤ºæ“ä½œï¼ˆæŒ‰åºæ‰§è¡Œï¼Œæ“ä½œé—´æœ‰å»¶æ—¶ï¼‰
  - ç‚¹äº®å•ä¸ª LEDï¼šç‚¹äº®ç´¢å¼• 2ï¼ˆç¬¬ 3 ä¸ª LEDï¼‰ï¼Œç­‰å¾… 1 ç§’ã€‚
  - ç†„ç­è¯¥å•ä¸ª LEDï¼Œç­‰å¾… 1 ç§’ã€‚
  - ä¸€æ¬¡æ€§å†™å…¥æ‰€æœ‰ LEDï¼šå†™å…¥ 0b00001111ï¼ˆç‚¹äº®å‰ 4 ä¸ªï¼‰ï¼Œç­‰å¾… 1 ç§’ã€‚
  - æŒ‰ç­‰çº§æ˜¾ç¤ºï¼šè°ƒç”¨ display_level(6)ï¼ˆç‚¹äº®å‰ 6 ä¸ªï¼‰ï¼Œç­‰å¾… 1 ç§’ã€‚
  - è·‘é©¬ç¯æ•ˆæžœï¼šå¾ªçŽ¯ 8 æ¬¡ï¼Œé€ä½ç§»åŠ¨ç‚¹äº®ï¼Œé—´éš” 0.2 ç§’ã€‚
  æœ€åŽå…¨éƒ¨ç†„ç­ï¼šè°ƒç”¨ clear() ç»“æŸã€‚
---
## è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³
### åˆ†å±‚è®¾è®¡
- åº•å±‚ï¼š`pcf8574.py` å°è£… PCF8574 èŠ¯ç‰‡çš„ I2C é€šä¿¡ä¸Ž GPIO æ“ä½œï¼Œå±è”½ç¡¬ä»¶å¯„å­˜å™¨ç»†èŠ‚ï¼Œæä¾›é€šç”¨ GPIO æŽ§åˆ¶æŽ¥å£ã€‚
- ä¸­å±‚ï¼š`led_bar.py` åŸºäºŽåº•å±‚é©±åŠ¨ï¼Œè¾“å‡ºç”µå¹³æŽ§åˆ¶æ¨¡å—ã€‚
- é«˜å±‚ï¼š`main.py` ä½œä¸ºåº”ç”¨ç¤ºä¾‹ï¼Œç»„åˆè°ƒç”¨åº•å±‚ä¸Žä¸­å±‚æ¨¡å—ï¼Œæ¼”ç¤ºå®Œæ•´ä½¿ç”¨æµç¨‹ï¼Œé™ä½Žå¼€å‘è€…ç§»æ¤éš¾åº¦ã€‚

### æŽ¥å£è§£è€¦
- ç¡¬ä»¶åˆå§‹åŒ–åˆ†ç¦»ï¼šI2C å®žä¾‹ç”±åº”ç”¨å±‚åˆ›å»ºå¹¶ä¼ å…¥ `PCF8574` ç±»ï¼Œé©±åŠ¨ä¸ç»‘å®šå…·ä½“ç¡¬ä»¶å¼•è„šï¼Œé€‚é… ESP32ã€æ ‘èŽ“æ´¾ Pico ç­‰ä¸åŒå¼€å‘æ¿ã€‚
- å›žè°ƒå‡½æ•°æ³¨å…¥ï¼šæŒ‰é”®çŠ¶æ€çš„å¤„ç†é€»è¾‘é€šè¿‡ `callback` å‚æ•°æ³¨å…¥ï¼Œå¼€å‘è€…å¯çµæ´»æ‰©å±•åŠŸèƒ½ï¼ˆå¦‚æŽ§åˆ¶ LEDã€å‘é€ä¸²å£æŒ‡ä»¤ç­‰ï¼‰ï¼Œæ— éœ€ä¿®æ”¹é©±åŠ¨ä»£ç ã€‚

### è·¨å¹³å°å…¼å®¹
- ä¾èµ–æœ€å°åŒ–ï¼šä»…ä½¿ç”¨ MicroPython æ ‡å‡†åº“ï¼ˆ`machine`ã€`time`ï¼‰ï¼Œä¸ä¾èµ–ç¡¬ä»¶å¹³å°ä¸“å±ž APIï¼Œç¡®ä¿åœ¨ä¸åŒ MicroPython å¼€å‘æ¿ä¸Šå‡å¯è¿è¡Œã€‚
- é…ç½®å‚æ•°åŒ–ï¼šI2C å¼•è„šã€è®¾å¤‡åœ°å€ã€æŒ‰é”®æ˜ å°„ã€æ¶ˆæŠ–æ—¶é—´ç­‰å‡é€šè¿‡å‚æ•°é…ç½®ï¼Œä¿®æ”¹ `main.py` ä¸­çš„å‚æ•°å³å¯é€‚é…ä¸åŒç¡¬ä»¶æŽ¥çº¿ï¼Œæ— éœ€æ”¹åŠ¨é©±åŠ¨æ–‡ä»¶ã€‚
---
## ä½¿ç”¨è¯´æ˜Ž
### ç¡¬ä»¶æŽ¥çº¿ï¼ˆæ ‘èŽ“æ´¾pico ç¤ºä¾‹ï¼‰
| PCF8574 å¼•è„š |  GPIO å¼•è„š | äº”å‘æŒ‰é”®æ¨¡å—è¿žæŽ¥ | å¤‡æ³¨ |
|--------------|----------------|------------------|------|
| VCC          | 3.3V           | -                | è‹¥æ¨¡å—æ”¯æŒ 5V å¯æŽ¥ 5Vï¼Œé¿å…è¿‡åŽ‹æŸå |
| GND          | GND            | GNDï¼ˆæŒ‰é”®å…¬å…±åœ°ï¼‰ | å¿…é¡»ä¸Žå¼€å‘æ¿å…±åœ°ï¼Œå¦åˆ™æŒ‰é”®çŠ¶æ€æ£€æµ‹å¼‚å¸¸ |
| SCL          | GPIO17         | -                | éœ€ä¸Žå¼€å‘æ¿ I2C SCL å¼•è„šå¯¹åº”ï¼Œä¸åŒå¼€å‘æ¿å¼•è„šä¸åŒ |
| SDA          | GPIO16         | -                | éœ€ä¸Žå¼€å‘æ¿ I2C SDA å¼•è„šå¯¹åº”ï¼Œä¸åŒå¼€å‘æ¿å¼•è„šä¸åŒ |

> **æ³¨æ„ï¼š**
> - æ ‘èŽ“æ´¾ Pico å¸¸ç”¨ I2C å¼•è„šï¼šI2C 0ï¼ˆSCL=GP1ã€SDA=GP0ï¼‰ã€I2C 1ï¼ˆSCL=GP3ã€SDA=GP2ï¼‰ï¼Œéœ€æ ¹æ®å®žé™…ä½¿ç”¨çš„ I2C æ€»çº¿è°ƒæ•´æŽ¥çº¿ã€‚

### è½¯ä»¶ä¾èµ–
- **å›ºä»¶ç‰ˆæœ¬**ï¼šMicroPython v1.23.0 åŠä»¥ä¸Š  
- **å†…ç½®åº“**ï¼š
  - `machine`ï¼šæä¾› I2C æ€»çº¿åˆå§‹åŒ–ã€GPIO æŽ§åˆ¶åŠŸèƒ½
  - `time`ï¼šæä¾›æ—¶é—´æˆ³è®°å½•ã€å»¶æ—¶åŠŸèƒ½ï¼Œç”¨äºŽæ¶ˆæŠ–ä¸Žå¾ªçŽ¯é—´éš”æŽ§åˆ¶
- **å¼€å‘å·¥å…·**ï¼šæŽ¨è Thonnyï¼ˆæ“ä½œç®€å•ï¼Œæ”¯æŒ MicroPython ç›´æŽ¥è¿è¡Œä¸Žè°ƒè¯•ï¼‰ã€PyCharmï¼ˆéœ€å®‰è£… MicroPython æ’ä»¶ï¼‰

### å®‰è£…æ­¥éª¤
1. **çƒ§å½•å›ºä»¶**ï¼šæ ¹æ®å¼€å‘æ¿åž‹å·ï¼ˆå¦‚ ESP32ã€æ ‘èŽ“æ´¾ Picoï¼‰ä¸‹è½½å¯¹åº” MicroPython å›ºä»¶ï¼Œé€šè¿‡çƒ§å½•å·¥å…·ï¼ˆå¦‚ esptoolã€Raspberry Pi Imagerï¼‰çƒ§å½•åˆ°å¼€å‘æ¿ã€‚
2. **ä¸Šä¼ æ–‡ä»¶**ï¼šé€šè¿‡å¼€å‘å·¥å…·å°† `pcf8574.py`ã€`led_bar.py`ã€`main.py` ä¸‰ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°å¼€å‘æ¿æ ¹ç›®å½•ã€‚
3. **ä¿®æ”¹é…ç½®**ï¼šæ‰“å¼€ `main.py`ï¼Œæ ¹æ®ç¡¬ä»¶æŽ¥çº¿ä¿®æ”¹ I2C å¼•è„šï¼ˆ`SCL_PIN`ã€`SDA_PIN`ï¼‰ã€PCF8574 åœ°å€ï¼ˆ`PCF8574_ADDR`ï¼‰ã€æŒ‰é”®-å¼•è„šæ˜ å°„ï¼ˆ`KEYS_MAP`ï¼‰ã€‚
4. **è¿è¡Œæµ‹è¯•**ï¼šåœ¨å¼€å‘å·¥å…·ä¸­è¿è¡Œ `main.py`ï¼Œæ“ä½œäº”å‘æŒ‰é”®ï¼Œé€šè¿‡ä¸²å£ç›‘è§†å™¨æŸ¥çœ‹æŒ‰é”®çŠ¶æ€æ‰“å°ä¿¡æ¯ï¼ˆæŒ‰ä¸‹/é‡Šæ”¾ï¼‰ã€‚
---
## ç¤ºä¾‹ç¨‹åº
```python
# Python env   : MicroPython v1.23.0
# -*- coding: utf-8 -*-
# @Time    : 2025/09/08 10:00
# @Author  : ä¾¯é’§ç€š
# @File    : main.py
# @Description : åŸºäºŽPCF8574èŠ¯ç‰‡çš„å…«æ®µå…‰æ¡æ•°ç ç®¡æ¨¡å—

# ======================================== å¯¼å…¥ç›¸å…³æ¨¡å— =========================================

from machine import I2C, Pin
#å¯¼å…¥pcf8574æ¨¡å—
from pcf8574 import PCF8574
#å¯¼å…¥åŸºäºŽPCF8574èŠ¯ç‰‡çš„å…«æ®µå…‰æ¡æ•°ç ç®¡æ¨¡å—
from led_bar import LEDBar
#æ—¶é—´ç›¸å…³æ¨¡å—
import time

# ======================================== å…¨å±€å˜é‡ ============================================

# ======================================== åŠŸèƒ½å‡½æ•° ============================================


# ======================================== è‡ªå®šä¹‰ç±» ============================================

# ======================================== åˆå§‹åŒ–é…ç½® ==========================================

# ä¸Šç”µå»¶æ—¶3s
time.sleep(3)
# æ‰“å°è°ƒè¯•æ¶ˆæ¯
print("FreakStudio: Test PCF8574 Module")
i2c = I2C(id=0, sda=Pin(4), scl=Pin(5), freq=100000)
# å¼€å§‹æ‰«æI2Cæ€»çº¿ä¸Šçš„è®¾å¤‡ï¼Œè¿”å›žä»Žæœºåœ°å€çš„åˆ—è¡¨
devices_list = i2c.scan()
print('START I2C SCANNER')

# è‹¥devices_listä¸ºç©ºï¼Œåˆ™æ²¡æœ‰è®¾å¤‡è¿žæŽ¥åˆ°I2Cæ€»çº¿ä¸Š
if len(devices_list) == 0:
    print("No i2c device !")
# è‹¥éžç©ºï¼Œåˆ™æ‰“å°ä»Žæœºè®¾å¤‡åœ°å€
else:
    print('i2c devices found:', len(devices_list))
    # éåŽ†ä»Žæœºè®¾å¤‡åœ°å€åˆ—è¡¨
    for device in devices_list:
        # åˆ¤æ–­è®¾å¤‡åœ°å€æ˜¯å¦ä¸ºPCF8575çš„åœ°å€
        if device >= 0x20 and device <= 0x27:
            print("I2C hexadecimal address: ", hex(device))
# åˆå§‹åŒ– PCF8574ï¼Œå‡è®¾åœ°å€ä¸º 0x20
pcf = PCF8574(i2c, address=device)

# ========================================  ä¸»ç¨‹åº  ===========================================

# åˆ›å»º LEDBar å®žä¾‹
ledbar = LEDBar(pcf)
# 1. å•ä¸ª LED ç‚¹äº®ï¼ˆç‚¹äº®ç¬¬ 3 ä¸ª LEDï¼‰
ledbar.set_led(2, True)
time.sleep(1)

# 2. å•ä¸ª LED ç†„ç­ï¼ˆå…³é—­ç¬¬ 3 ä¸ª LEDï¼‰
ledbar.set_led(2, False)
time.sleep(1)

# 3. è®¾ç½®æ‰€æœ‰ LEDï¼ˆä¾‹å¦‚ç‚¹äº®å‰ 4 ä¸ªï¼‰
ledbar.set_all(0b00001111)
time.sleep(1)

# 4. æ˜¾ç¤º levelï¼ˆä¾‹å¦‚ç‚¹äº®å‰ 6 ä¸ª LEDï¼‰
ledbar.display_level(6)
time.sleep(1)

# 5. è·‘é©¬ç¯æ•ˆæžœ
for i in range(8):
    ledbar.set_all(1 << i)
    time.sleep(0.2)

# 6. å…¨éƒ¨ç†„ç­
ledbar.clear()

```
---
## æ³¨æ„äº‹é¡¹
### 1. ç¡¬ä»¶è¿žæŽ¥é—®é¢˜
- **ç”µæºåŒ¹é…**ï¼šPCF8574 æ¨¡å—è‹¥ä¸º 3.3V ç‰ˆæœ¬ï¼Œä¸å¯æŽ¥ 5V ç”µæºï¼›5V ç‰ˆæœ¬å¯å…¼å®¹ 3.3Vï¼Œä½†éœ€ç¡®è®¤æ¨¡å—æ˜¯å¦å¸¦ç”µåŽ‹è½¬æ¢ç”µè·¯ï¼Œé¿å…èŠ¯ç‰‡çƒ§æ¯ã€‚
- **å…±åœ°è¦æ±‚**ï¼šPCF8574 çš„ GND å¿…é¡»ä¸Žå¼€å‘æ¿ GND ç›´æŽ¥è¿žæŽ¥ï¼Œå¦åˆ™ I2C é€šä¿¡ä¼šå› ç”µå¹³å‚è€ƒä¸ä¸€è‡´å¯¼è‡´å¤±è´¥æˆ–æ•°æ®å¼‚å¸¸ã€‚
- **ä¸Šæ‹‰ç”µé˜»**ï¼šPCF8574 å¼•è„šä¸ºå¼€æ¼è¾“å‡ºï¼Œä½œä¸ºæŒ‰é”®è¾“å…¥æ—¶éœ€ä¸Šæ‹‰ï¼ˆæ¨¡å—å†…ç½®æˆ–å¤–æŽ¥ï¼‰ï¼›æ— ä¸Šå¤©æ‹‰æ—¶ï¼ŒæŒ‰é”®æŒ‰ä¸‹/é‡Šæ”¾çŠ¶æ€å¯èƒ½æ— æ³•æ­£ç¡®æ£€æµ‹ã€‚

### 2. è½¯ä»¶é…ç½®é—®é¢˜
- **I2C åœ°å€å†²çª**ï¼šè‹¥åŒä¸€ I2C æ€»çº¿è¿žæŽ¥å¤šä¸ªè®¾å¤‡ï¼Œéœ€ç¡®ä¿å„è®¾å¤‡åœ°å€ä¸åŒï¼ˆPCF8574 åœ°å€å¯é€šè¿‡ A0/A1/A2 å¼•è„šè°ƒæ•´ï¼ŒèŒƒå›´ 0x20-0x27ï¼‰ï¼Œé¿å…é€šä¿¡å†²çªã€‚
- **æ¶ˆæŠ–æ—¶é—´è°ƒæ•´**ï¼šè‹¥æŒ‰é”®ä»æœ‰è¯¯è§¦å‘ï¼Œå¯å¢žå¤§ `debounce_time`ï¼ˆå¦‚ 100msï¼‰ï¼›è‹¥æŒ‰é”®å“åº”è¿Ÿé’ï¼Œå¯é€‚å½“å‡å°ï¼ˆå¦‚ 30msï¼‰ï¼Œéœ€æ ¹æ®æŒ‰é”®æœºæ¢°ç‰¹æ€§è°ƒæ•´ã€‚
- **å¾ªçŽ¯é—´éš”æŽ§åˆ¶**ï¼šä¸»å¾ªçŽ¯ä¸­ `update()` è°ƒç”¨é—´éš”å»ºè®®ä¸è¶…è¿‡ `debounce_time` çš„ä¸€åŠï¼ˆå¦‚æ¶ˆæŠ– 50ms æ—¶ï¼Œé—´éš” 20msï¼‰ï¼Œç¡®ä¿ä¸é—æ¼æŒ‰é”®çŠ¶æ€å˜åŒ–ã€‚

### 3. æ€§èƒ½ä¸Žç¨³å®šæ€§
- **é‡‡æ ·é¢‘çŽ‡**ï¼šå•æ¬¡æŒ‰é”®æ£€æµ‹ï¼ˆ`read_all()`+`update()`ï¼‰è€—æ—¶çº¦ 1-2msï¼Œå»ºè®®æ¯ç§’é‡‡æ ·ä¸è¶…è¿‡ 100 æ¬¡ï¼Œé¿å…å ç”¨è¿‡å¤š CPU èµ„æºå½±å“å…¶ä»–åŠŸèƒ½ã€‚
- **èµ„æºé‡Šæ”¾**ï¼šç¨‹åºç»ˆæ­¢æ—¶éœ€é€šè¿‡é”®ç›˜ä¸­æ–­ï¼ˆCtrl+Cï¼‰è§¦å‘èµ„æºé‡Šæ”¾é€»è¾‘ï¼Œé¿å…ç›´æŽ¥æ–­ç”µå¯¼è‡´ I2C æ€»çº¿å¤„äºŽå¼‚å¸¸çŠ¶æ€ï¼Œå½±å“ä¸‹æ¬¡å¯åŠ¨ã€‚
- **çŽ¯å¢ƒå¹²æ‰°**ï¼šå¼ºç”µç£çŽ¯å¢ƒï¼ˆå¦‚ç”µæœºã€ç»§ç”µå™¨é™„è¿‘ï¼‰å¯èƒ½å¹²æ‰° I2C é€šä¿¡ï¼Œå»ºè®®ä½¿ç”¨å±è”½çº¿è¿žæŽ¥ SCL/SDA å¼•è„šï¼Œæˆ–å¢žåŠ  100nF æ»¤æ³¢ç”µå®¹ï¼ˆé è¿‘ PCF8574 VCC-GND å¼•è„šï¼‰ã€‚
---

## è”ç³»æ–¹å¼
å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»å¼€å‘è€…ï¼š  
ðŸ“§ **é‚®ç®±**ï¼š1098875044@qq.com  
ðŸ’» **GitHub**ï¼šhttps://github.com/FreakStudioCN

---

## è®¸å¯åè®®
æœ¬é¡¹ç›®ä¸­ï¼Œé™¤ `machine` ç­‰ MicroPython å®˜æ–¹æ¨¡å—ï¼ˆMIT è®¸å¯è¯ï¼‰å¤–ï¼Œæ‰€æœ‰ç”±ä½œè€…ç¼–å†™çš„é©±åŠ¨ä¸Žæ‰©å±•ä»£ç å‡é‡‡ç”¨ **çŸ¥è¯†å…±äº«ç½²å-éžå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…ç‰ˆ (MIT)** è®¸å¯åè®®å‘å¸ƒã€‚  

æ‚¨å¯ä»¥è‡ªç”±åœ°ï¼š  
- **å…±äº«** â€” åœ¨ä»»ä½•åª’ä»‹ä»¥ä»»ä½•å½¢å¼å¤åˆ¶ã€å‘è¡Œæœ¬ä½œå“  
- **æ¼”ç»Ž** â€” ä¿®æ”¹ã€è½¬æ¢æˆ–ä»¥æœ¬ä½œå“ä¸ºåŸºç¡€è¿›è¡Œåˆ›ä½œ  

æƒŸé¡»éµå®ˆä¸‹åˆ—æ¡ä»¶ï¼š  
- **ç½²å** â€” æ‚¨å¿…é¡»ç»™å‡ºé€‚å½“çš„ç½²åï¼Œæä¾›æŒ‡å‘æœ¬è®¸å¯åè®®çš„é“¾æŽ¥ï¼ŒåŒæ—¶æ ‡æ˜Žæ˜¯å¦ï¼ˆå¯¹åŽŸå§‹ä½œå“ï¼‰ä½œäº†ä¿®æ”¹ã€‚æ‚¨å¯ä»¥ç”¨ä»»ä½•åˆç†çš„æ–¹å¼æ¥ç½²åï¼Œä½†æ˜¯ä¸å¾—ä»¥ä»»ä½•æ–¹å¼æš—ç¤ºè®¸å¯äººä¸ºæ‚¨æˆ–æ‚¨çš„ä½¿ç”¨èƒŒä¹¦ã€‚  
- **éžå•†ä¸šæ€§ä½¿ç”¨** â€” æ‚¨ä¸å¾—å°†æœ¬ä½œå“ç”¨äºŽå•†ä¸šç›®çš„ã€‚  
- **åˆç†å¼•ç”¨æ–¹å¼** â€” å¯åœ¨ä»£ç æ³¨é‡Šã€æ–‡æ¡£ã€æ¼”ç¤ºè§†é¢‘æˆ–é¡¹ç›®è¯´æ˜Žä¸­æ˜Žç¡®æ¥æºã€‚  
- **è¯´æ˜Ž** â€” ä»£ç å«å‚è€ƒéƒ¨åˆ†,å‡ºçŽ°éžæŠ€æœ¯é—®é¢˜å’Œç½²åä½œè€…æ— å…³ã€‚  
**ç‰ˆæƒå½’ FreakStudio æ‰€æœ‰ã€‚**
