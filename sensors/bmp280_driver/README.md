# BMP280 æ¸©æ¹¿åº¦æ°”å‹ä¼ æ„Ÿå™¨é©±åŠ¨ - MicroPythonç‰ˆæœ¬

## ç›®å½•
- [ç®€ä»‹](#ç®€ä»‹)
- [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
- [ç¡¬ä»¶è¦æ±‚](#ç¡¬ä»¶è¦æ±‚)
- [æ–‡ä»¶è¯´æ˜](#æ–‡ä»¶è¯´æ˜)
- [è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³](#è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³)
- [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
- [ç¤ºä¾‹ç¨‹åº](#ç¤ºä¾‹ç¨‹åº)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
- [è”ç³»æ–¹å¼](#è”ç³»æ–¹å¼)
- [è®¸å¯åè®®](#è®¸å¯åè®®)

---

## ç®€ä»‹
BMP280 æ˜¯ä¸€æ¬¾é›†æˆæ¸©åº¦ã€æ¹¿åº¦å’Œæ°”å‹æµ‹é‡åŠŸèƒ½çš„é«˜ç²¾åº¦ä¼ æ„Ÿå™¨ï¼Œé‡‡ç”¨ I2C é€šä¿¡æ¥å£ï¼Œå¹¿æ³›åº”ç”¨äºæ°”è±¡ç›‘æµ‹ã€ç¯å¢ƒæ§åˆ¶ã€ç‰©è”ç½‘è®¾å¤‡ç­‰åœºæ™¯ã€‚è¯¥ä¼ æ„Ÿå™¨å…·æœ‰ä½åŠŸè€—ã€é«˜ç²¾åº¦ã€å®½æµ‹é‡èŒƒå›´ç­‰ç‰¹ç‚¹ï¼Œèƒ½å¤ŸåŒæ—¶æä¾›ç¯å¢ƒæ¸©åº¦ï¼ˆÂ°Cï¼‰ã€ç›¸å¯¹æ¹¿åº¦ï¼ˆ%ï¼‰å’Œå¤§æ°”å‹å¼ºï¼ˆhPaï¼‰æ•°æ®ï¼Œå¹¶æ”¯æŒæµ·æ‹”é«˜åº¦å’Œéœ²ç‚¹æ¸©åº¦è®¡ç®—ã€‚

æœ¬é¡¹ç›®æä¾›åŸºäº MicroPython çš„ BMP280 é©±åŠ¨ä»£ç ï¼ˆæµ®ç‚¹å‹ç‰ˆæœ¬ï¼‰åŠæµ‹è¯•ç¨‹åºï¼Œæ–¹ä¾¿å¼€å‘è€…å¿«é€Ÿé›†æˆä¼ æ„Ÿå™¨åŠŸèƒ½ã€‚

---

## ä¸»è¦åŠŸèƒ½
- **å¤šå‚æ•°æµ‹é‡**ï¼šåŒæ—¶é‡‡é›†æ¸©åº¦ã€æ¹¿åº¦å’Œæ°”å‹æ•°æ®
- **æ‰©å±•è®¡ç®—**ï¼šæ”¯æŒæµ·æ‹”é«˜åº¦ï¼ˆåŸºäºæ°”å‹ï¼‰å’Œéœ²ç‚¹æ¸©åº¦ï¼ˆåŸºäºæ¸©æ¹¿åº¦ï¼‰è®¡ç®—
- **é‡‡æ ·ç²¾åº¦é…ç½®**ï¼šå¯è®¾ç½®ä¸åŒçš„é‡‡æ ·ç²¾åº¦ï¼ˆ1~16æ¬¡é‡‡æ ·ï¼‰
- **æ•°æ®æ ¼å¼åŒ–**ï¼šæä¾›åŸå§‹æµ®ç‚¹æ•°æ®å’Œæ ¼å¼åŒ–å­—ç¬¦ä¸²è¾“å‡º
- **æ ¡å‡†è¡¥å¿**ï¼šå†…ç½®ä¼ æ„Ÿå™¨æ ¡å‡†å‚æ•°è¯»å–ä¸æ•°æ®è¡¥å¿ç®—æ³•
- **è·¨å¹³å°æ”¯æŒ**ï¼šå…¼å®¹æ‰€æœ‰æ”¯æŒ MicroPython çš„ç¡¬ä»¶å¹³å°ï¼ˆå¦‚ ESP32ã€ESP8266ã€æ ‘è“æ´¾ Pico ç­‰ï¼‰

---

## ç¡¬ä»¶è¦æ±‚
### æ¨èæµ‹è¯•ç¡¬ä»¶
- æ”¯æŒ MicroPython çš„å¼€å‘æ¿ï¼ˆå¦‚ ESP32ã€ESP8266ã€æ ‘è“æ´¾ Picoï¼‰
- BMP280 ä¼ æ„Ÿå™¨æ¨¡å—
- æœé‚¦çº¿è‹¥å¹²

### æ¨¡å—å¼•è„šè¯´æ˜
| BMP280 å¼•è„š | åŠŸèƒ½æè¿°                          |
|-----------|-------------------------------|
| VCC       | ç”µæºæ­£æ                          |
| GND       | ç”µæºè´Ÿæ                          |
| SCL       | I2C æ—¶é’Ÿçº¿                       |
| SDA       | I2C æ•°æ®çº¿                       |
| CSB       | èŠ¯ç‰‡é€‰æ‹©ï¼ˆI2Cæ¨¡å¼ä¸‹æ¥é«˜ç”µå¹³ï¼Œé»˜è®¤å†…éƒ¨ä¸Šæ‹‰ï¼‰       |
| SDO       | åœ°å€é€‰æ‹©ï¼ˆæ¥GNDæ—¶åœ°å€ä¸º0x76ï¼Œæ¥VCCæ—¶ä¸º0x77ï¼‰ |

---
## æ–‡ä»¶è¯´æ˜
### bmP280_float.py
æ ¸å¿ƒé©±åŠ¨æ–‡ä»¶ï¼ŒåŒ…å« `BMP280` ç±»å®ç°ä¼ æ„Ÿå™¨æ§åˆ¶ï¼š

- **ç±» `BMP280`**ï¼šBMP280 ä¼ æ„Ÿå™¨æ§åˆ¶æ ¸å¿ƒç±»ï¼Œæä¾›å®Œæ•´çš„æ•°æ®è¯»å–ä¸å¤„ç†åŠŸèƒ½
  
  - `__init__()`ï¼šåˆå§‹åŒ–ä¼ æ„Ÿå™¨ï¼ŒåŠ è½½æ ¡å‡†å‚æ•°ï¼Œé…ç½®é‡‡æ ·æ¨¡å¼å’Œ I2C é€šä¿¡
  - `read_raw_data(result)`ï¼šè¯»å–åŸå§‹æ¸©åº¦ã€æ°”å‹ã€æ¹¿åº¦æ•°æ®åˆ°æŒ‡å®šæ•°ç»„
  - `read_compensated_data(result=None)`ï¼šè¿”å›ç»è¿‡æ ¡å‡†çš„æµ®ç‚¹å‹æ¸©åº¦(Â°C)ã€æ°”å‹(Pa)å’Œæ¹¿åº¦(%)
  - `sealevel`ï¼ˆå±æ€§ï¼‰ï¼šè·å–æˆ–è®¾ç½®æµ·å¹³é¢æ ‡å‡†æ°”å‹ï¼ˆPaï¼‰ï¼Œç”¨äºæµ·æ‹”è®¡ç®—
  - `altitude`ï¼ˆå±æ€§ï¼‰ï¼šæ ¹æ®å½“å‰æ°”å‹å’Œæµ·å¹³é¢æ°”å‹è®¡ç®—æµ·æ‹”é«˜åº¦ï¼ˆç±³ï¼‰
  - `dew_point`ï¼ˆå±æ€§ï¼‰ï¼šåŸºäºå½“å‰æ¸©åº¦å’Œæ¹¿åº¦è®¡ç®—éœ²ç‚¹æ¸©åº¦ï¼ˆÂ°Cï¼‰
  - `values`ï¼ˆå±æ€§ï¼‰ï¼šè¿”å›æ ¼å¼åŒ–çš„æ¸©åº¦("xx.xxC")ã€æ°”å‹("xxxx.xxhPa")ã€æ¹¿åº¦("xx.xx%")å­—ç¬¦ä¸²å…ƒç»„

### main.py
æµ‹è¯•ç¨‹åºæ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½ï¼š

- åˆå§‹åŒ– I2C æ€»çº¿å’Œ BMP280 ä¼ æ„Ÿå™¨å®ä¾‹
- å¾ªç¯è¯»å–ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆæ¸©åº¦ã€æ°”å‹ã€æ¹¿åº¦ã€æµ·æ‹”ã€éœ²ç‚¹ï¼‰
- æ‰“å°åŸå§‹æ•°æ®å’Œæ ¼å¼åŒ–æ•°æ®ï¼ŒéªŒè¯ä¼ æ„Ÿå™¨å·¥ä½œçŠ¶æ€
- æ”¯æŒé”®ç›˜ä¸­æ–­ï¼ˆCtrl+Cï¼‰ä¼˜é›…ç»ˆæ­¢ç¨‹åº

---

## è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³
### æ ¡å‡†è¡¥å¿æœºåˆ¶
- è¯»å–ä¼ æ„Ÿå™¨å†…ç½®çš„æ ¡å‡†å‚æ•°ï¼ˆdig_Txã€dig_Pxã€dig_Hxç³»åˆ—ï¼‰
- åŸºäºæ ¡å‡†å‚æ•°å¯¹åŸå§‹æ•°æ®è¿›è¡Œè¡¥å¿è®¡ç®—ï¼Œæé«˜æµ‹é‡ç²¾åº¦
- æ¸©åº¦æ•°æ®ç”¨äºæ°”å‹å’Œæ¹¿åº¦çš„è¡¥å¿è®¡ç®—ï¼ˆt_fineå˜é‡ä¼ é€’ï¼‰

### åˆ†å±‚è®¾è®¡
- åº•å±‚ï¼šåŸå§‹æ•°æ®è¯»å–ï¼ˆread_raw_dataï¼‰
- ä¸­å±‚ï¼šæ•°æ®è¡¥å¿è½¬æ¢ï¼ˆread_compensated_dataï¼‰
- é«˜å±‚ï¼šåº”ç”¨çº§è®¡ç®—ï¼ˆaltitudeã€dew_pointï¼‰å’Œæ ¼å¼åŒ–è¾“å‡ºï¼ˆvaluesï¼‰

### èµ„æºä¼˜åŒ–
- ä½¿ç”¨å¤ç”¨ç¼“å†²åŒºï¼ˆbytearrayå’Œarrayï¼‰å‡å°‘å†…å­˜åˆ†é…
- é€šè¿‡å±æ€§ï¼ˆ@propertyï¼‰å°è£…å¸¸ç”¨è®¡ç®—ï¼Œå®ç°æŒ‰éœ€è®¡ç®—
- é™åˆ¶æµ‹é‡èŒƒå›´ï¼ˆå¦‚æ¹¿åº¦0~100%ï¼Œæ¸©åº¦-40~85Â°Cï¼‰ç¡®ä¿æ•°æ®æœ‰æ•ˆæ€§

### æ¥å£æŠ½è±¡
- ç»Ÿä¸€çš„I2Cæ¥å£ï¼Œå±è”½ä¸åŒç¡¬ä»¶å¹³å°çš„å·®å¼‚
- çµæ´»çš„é‡‡æ ·æ¨¡å¼é…ç½®ï¼Œæ”¯æŒå•ä¸€æ¨¡å¼æˆ–åˆ†åˆ«é…ç½®æ¸©æ¹¿åº¦æ°”å‹é‡‡æ ·ç²¾åº¦

---

## ä½¿ç”¨è¯´æ˜
### ç¡¬ä»¶æ¥çº¿ï¼ˆæ ‘è“æ´¾pico ç¤ºä¾‹ï¼‰

| BMP280 å¼•è„š |GPIO å¼•è„š |
|-----------|---------------|
| VCC       | 5V            |
| GND       | GND           |
| SCL       | GPIO21        |
| SDA       | GPIO20        |

> **æ³¨æ„ï¼š**
> - ä¼ æ„Ÿå™¨ä»…æ”¯æŒ5Vä¾›ç”µ
> - ä¸åŒå¼€å‘æ¿çš„I2Cå¼•è„šå¯èƒ½ä¸åŒï¼Œè¯·æ ¹æ®å®é™…ç¡¬ä»¶ä¿®æ”¹
> - SDOå¼•è„šæ¥åœ°æ—¶I2Cåœ°å€ä¸º0x76ï¼Œæ¥VCCæ—¶ä¸º0x77

---

### è½¯ä»¶ä¾èµ–
- **å›ºä»¶ç‰ˆæœ¬**ï¼šMicroPython v1.19+
- **å†…ç½®åº“**ï¼š
  - `machine`ï¼ˆç”¨äºI2Cå’ŒGPIOæ§åˆ¶ï¼‰
  - `time`ï¼ˆç”¨äºå»¶æ—¶ï¼‰
  - `struct`ã€`array`ã€`micropython`ï¼ˆé©±åŠ¨å†…éƒ¨ä½¿ç”¨ï¼‰
- **å¼€å‘å·¥å…·**ï¼šPyCharm æˆ– Thonnyï¼ˆæ¨èï¼‰

---

### å®‰è£…æ­¥éª¤
1. å°† MicroPython å›ºä»¶çƒ§å½•åˆ°å¼€å‘æ¿
2. ä¸Šä¼  `bmp280_float.py` å’Œ `main.py` åˆ°å¼€å‘æ¿
3. æ ¹æ®ç¡¬ä»¶è¿æ¥ä¿®æ”¹ `main.py` ä¸­çš„I2Cå¼•è„šé…ç½®
4. è¿è¡Œ `main.py` å¼€å§‹æµ‹è¯•

---

## ç¤ºä¾‹ç¨‹åº
```python
# Python env   : MicroPython v1.23.0
# -*- coding: utf-8 -*-
# @Time    : 2025/9/9 ä¸Šåˆ11:25
# @Author  : ç¼ªè´µæˆ
# @File    : main.py
# @Description : åŸºäºBMP280çš„å¤§æ°”å‹å¼ºæ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨æ¨¡å—é©±åŠ¨æµ‹è¯•ç¨‹åº

# ======================================== å¯¼å…¥ç›¸å…³æ¨¡å— =========================================

import time
from machine import I2C
from bmp280_float import BMP280

# ======================================== å…¨å±€å˜é‡ =============================================

bmp_addr = None

# ======================================== åŠŸèƒ½å‡½æ•° =============================================

# ======================================== è‡ªå®šä¹‰ç±» =============================================

# ======================================== åˆå§‹åŒ–é…ç½® ============================================

time.sleep(3)
print("FreakStudio:Testing BMP280 pressure, temperature, and humidity sensor")
# æ³¨æ„ï¼šå¼•è„šå·æ ¹æ®å®é™…ç¡¬ä»¶ä¿®æ”¹
i2c = I2C(0, scl=1, sda=0, freq=100000)
# å¼€å§‹æ‰«æI2Cæ€»çº¿ä¸Šçš„è®¾å¤‡ï¼Œè¿”å›ä»æœºåœ°å€çš„åˆ—è¡¨
devices_list:list[int] = i2c.scan()
print('START I2C SCANNER')
# è‹¥devices listä¸ºç©ºï¼Œåˆ™æ²¡æœ‰è®¾å¤‡è¿æ¥åˆ°I2Cæ€»çº¿ä¸Š
if len(devices_list) == 0:
    # è‹¥éç©ºï¼Œåˆ™æ‰“å°ä»æœºè®¾å¤‡åœ°å€
    print("No i2c device !")
else:
    print('i2c devices found:', len(devices_list))
for device in devices_list:
    if 0x60 <= device <= 0x7A:
        print("I2c hexadecimal address:", hex(device))
        bmp_addr = device

bmp = BMP280(i2c=i2c, address=bmp_addr)

# ======================================== ä¸»ç¨‹åº ===============================================
try:
    while True:
        # è·å–æµ®ç‚¹æ•°æ¸©æ¹¿åº¦å’Œæ°”å‹
        temp, press, hum = bmp.read_compensated_data()
        # è½¬æ¢æ°”å‹å•ä½ä¸º hPaï¼ˆ1 hPa = 100 Paï¼‰
        press_hpa = press / 100.0
        # è®¡ç®—æµ·æ‹”é«˜åº¦
        sea_level_hpa = 1013.25
        altitude = 44330.0 * (1.0 - (press_hpa / sea_level_hpa) ** 0.1903)
        # æ‰“å°æµ®ç‚¹ä¿¡æ¯
        print("Temperature: {:.2f} Â°C | Humidity: {:.2f}% | Pressure: {:.2f} hPa".format(
            temp, hum, press_hpa
        ))
        print(altitude)
        time.sleep(2)
except KeyboardInterrupt:
    print("\nTest stopped")




```
---
## æ³¨æ„äº‹é¡¹
### ç”µæºè¦æ±‚
- å¿…é¡»ä½¿ç”¨ 3.3V ç”µæºä¾›ç”µï¼Œæ¥ 5V ä¼šæŸåä¼ æ„Ÿå™¨
- ç¡®ä¿ç”µæºç¨³å®šï¼Œé¿å…ç”µå‹æ³¢åŠ¨å½±å“æµ‹é‡ç²¾åº¦
- é•¿è·ç¦»æ¥çº¿æ—¶å»ºè®®åœ¨ SDA å’Œ SCL çº¿ä¸Šæ·»åŠ  10K ä¸Šæ‹‰ç”µé˜»

### æµ‹é‡èŒƒå›´
| å‚æ•° | æµ‹é‡èŒƒå›´ | ç²¾åº¦ |
|------|----------|------|
| æ¸©åº¦ | -40 ~ 85 Â°C | Â±1.0 Â°C |
| æ¹¿åº¦ | 0 ~ 100 %RH | Â±3 %RH |
| æ°”å‹ | 300 ~ 1100 hPa | Â±1 hPa |

### é‡‡æ ·æ¨¡å¼
- é‡‡æ ·æ¬¡æ•°è¶Šå¤šï¼Œç²¾åº¦è¶Šé«˜ï¼Œä½†åŠŸè€—å’Œæµ‹é‡æ—¶é—´ä¹Ÿè¶Šé•¿
- æ¨èæ¨¡å¼ï¼šBMP280_OSAMPLE_8ï¼ˆå¹³è¡¡ç²¾åº¦å’Œæ•ˆç‡ï¼‰
- å¯é€šè¿‡ tuple åˆ†åˆ«è®¾ç½®æ¹¿åº¦ã€æ¸©åº¦ã€æ°”å‹çš„é‡‡æ ·æ¨¡å¼ï¼Œä¾‹å¦‚ `mode=(BMP280_OSAMPLE_16, BMP280_OSAMPLE_8, BMP280_OSAMPLE_4)`

### æµ·æ‹”è®¡ç®—
- æµ·æ‹”é«˜åº¦è®¡ç®—ä¾èµ–æµ·å¹³é¢æ°”å‹è®¾ç½®ï¼ˆé»˜è®¤ 101325 Paï¼‰
- å¯é€šè¿‡ `bmp.sealevel = 101300` è°ƒæ•´æµ·å¹³é¢æ°”å‹å€¼ï¼ˆå•ä½ Paï¼‰
- å®é™…åº”ç”¨ä¸­å»ºè®®æ ¹æ®å½“åœ°æµ·æ‹”æ ¡å‡†æµ·å¹³é¢æ°”å‹

### è½¯ä»¶é™åˆ¶
- I2C æ“ä½œé ISR-safeï¼Œä¸è¦åœ¨ä¸­æ–­æœåŠ¡ç¨‹åºä¸­è°ƒç”¨
- ä¼ æ„Ÿå™¨åˆå§‹åŒ–æ—¶ä¼šè¯»å–æ ¡å‡†æ•°æ®ï¼Œéœ€ç¡®ä¿ I2C é€šä¿¡æ­£å¸¸
- è¿ç»­è¯»å–é—´éš”å»ºè®®ä¸å°äº 100msï¼Œé¿å…æ•°æ®ä¸ç¨³å®š
---
## è”ç³»æ–¹å¼
å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»å¼€å‘è€…ï¼š  
ğŸ“§ é‚®ç®±ï¼š10696531183@qq.com  
ğŸ’» GitHubï¼šhttps://github.com/FreakStudioCN
---
## è®¸å¯åè®®
æœ¬é¡¹ç›®ä¸­ï¼Œé™¤ `machine` ç­‰ MicroPython å®˜æ–¹æ¨¡å—ï¼ˆMIT è®¸å¯è¯ï¼‰å¤–ï¼Œæ‰€æœ‰ç”±ä½œè€…ç¼–å†™çš„é©±åŠ¨ä¸æ‰©å±•ä»£ç å‡é‡‡ç”¨ **çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…ç‰ˆ (CC BY-NC 4.0)** è®¸å¯åè®®å‘å¸ƒã€‚  

æ‚¨å¯ä»¥è‡ªç”±åœ°ï¼š  
- **å…±äº«** â€” åœ¨ä»»ä½•åª’ä»‹ä»¥ä»»ä½•å½¢å¼å¤åˆ¶ã€å‘è¡Œæœ¬ä½œå“  
- **æ¼”ç»** â€” ä¿®æ”¹ã€è½¬æ¢æˆ–ä»¥æœ¬ä½œå“ä¸ºåŸºç¡€è¿›è¡Œåˆ›ä½œ  

æƒŸé¡»éµå®ˆä¸‹åˆ—æ¡ä»¶ï¼š  
- **ç½²å** â€” æ‚¨å¿…é¡»ç»™å‡ºé€‚å½“çš„ç½²åï¼Œæä¾›æŒ‡å‘æœ¬è®¸å¯åè®®çš„é“¾æ¥ï¼ŒåŒæ—¶æ ‡æ˜æ˜¯å¦ï¼ˆå¯¹åŸå§‹ä½œå“ï¼‰ä½œäº†ä¿®æ”¹ã€‚  
- **éå•†ä¸šæ€§ä½¿ç”¨** â€” æ‚¨ä¸å¾—å°†æœ¬ä½œå“ç”¨äºå•†ä¸šç›®çš„ã€‚  
- **åˆç†å¼•ç”¨æ–¹å¼** â€” å¯åœ¨ä»£ç æ³¨é‡Šã€æ–‡æ¡£ã€æ¼”ç¤ºè§†é¢‘æˆ–é¡¹ç›®è¯´æ˜ä¸­æ˜ç¡®æ¥æºã€‚
- **å£°æ˜** â€”ä»£ç å«æœ‰å‚è€ƒéƒ¨åˆ†ï¼Œäº§ç”Ÿé—®é¢˜ä¸ç½²åä½œè€…æ— å…³ã€‚

**ç‰ˆæƒå½’ FreakStudio æ‰€æœ‰ã€‚**