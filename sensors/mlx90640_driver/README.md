# MLX90640 çº¢å¤–æ¸©åº¦ä¼ æ„Ÿå™¨é©±åŠ¨ - MicroPythonç‰ˆæœ¬

## ç›®å½•
- [ç®€ä»‹](#ç®€ä»‹)
- [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
- [ç¡¬ä»¶è¦æ±‚](#ç¡¬ä»¶è¦æ±‚)
- [æ–‡ä»¶è¯´æ˜](#æ–‡ä»¶è¯´æ˜)
- [è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³](#è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³)
- [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
- [ç¤ºä¾‹ç¨‹åº](#ç¤ºä¾‹ç¨‹åº)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
- [è”ç³»æ–¹å¼](#è”ç³»æ–¹å¼)
- [è®¸å¯åè®®](#è®¸å¯åè®®)

---

## ç®€ä»‹
MLX90640æ˜¯ä¸€æ¬¾åŸºäºçº¢å¤–æ£€æµ‹åŸç†çš„24Ã—32ç‚¹é˜µæ¸©åº¦ä¼ æ„Ÿå™¨ï¼Œå¯å®ç°éæ¥è§¦å¼æ¸©åº¦æµ‹é‡ï¼Œæ£€æµ‹èŒƒå›´å¹¿ï¼ˆ-40â„ƒè‡³300â„ƒï¼‰ï¼Œé€‚ç”¨äºä½“æ¸©æ£€æµ‹ã€å·¥ä¸šæµ‹æ¸©ã€æ™ºèƒ½å®¶å±…ç¯å¢ƒç›‘æ§ç­‰åœºæ™¯ã€‚

æœ¬é¡¹ç›®æä¾›åŸºäºMicroPythonçš„MLX90640ä¼ æ„Ÿå™¨é©±åŠ¨åŠæµ‹è¯•ç¨‹åºï¼Œé€šè¿‡I2Cæ¥å£ä¸ä¼ æ„Ÿå™¨é€šä¿¡ï¼Œæ”¯æŒæ¸©åº¦æ•°æ®é‡‡é›†ã€åˆ·æ–°ç‡é…ç½®ç­‰åŠŸèƒ½ï¼Œé€‚é…å¤šç§MicroPythonå¼€å‘æ¿ã€‚

---

## ä¸»è¦åŠŸèƒ½
- **å®Œæ•´æ•°æ®é‡‡é›†**ï¼šè¯»å–24Ã—32ç‚¹é˜µçš„å…¨éƒ¨æ¸©åº¦æ•°æ®
- **çµæ´»é…ç½®**ï¼šæ”¯æŒå¤šç§åˆ·æ–°ç‡è®¾ç½®ï¼ˆ0.5Hzè‡³64Hzï¼‰
- **æ•°æ®å¤„ç†**ï¼šæä¾›æ¸©åº¦æ•°æ®è½¬æ¢ä¸åŸºæœ¬ç»Ÿè®¡ï¼ˆæœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼ï¼‰
- **I2Cé€šä¿¡**ï¼šé€šè¿‡æ ‡å‡†I2Cæ¥å£å®ç°ä¸ä¼ æ„Ÿå™¨çš„é€šä¿¡
- **è·¨å¹³å°å…¼å®¹**ï¼šæ ‘è“æ´¾Picoç­‰å¼€å‘æ¿

---

## ç¡¬ä»¶è¦æ±‚
### æ¨èæµ‹è¯•ç¡¬ä»¶
- MicroPythonå…¼å®¹å¼€å‘æ¿ï¼ˆESP32/ESP8266/æ ‘è“æ´¾Picoï¼‰
- MLX90640çº¢å¤–æ¸©åº¦ä¼ æ„Ÿå™¨æ¨¡å—
- æœé‚¦çº¿è‹¥å¹²
- é¢åŒ…æ¿ï¼ˆå¯é€‰ï¼Œç”¨äºæ¥çº¿æµ‹è¯•ï¼‰

### æ¨¡å—å¼•è„šè¯´æ˜
| MLX90640å¼•è„š | åŠŸèƒ½æè¿° |
|--------------|----------|
| VCC          | ç”µæºæ­£æï¼ˆ3.3Vï¼Œä¸å¯æ¥5Vï¼‰ |
| GND          | ç”µæºè´Ÿæ |
| SCL          | I2Cæ—¶é’Ÿçº¿ |
| SDA          | I2Cæ•°æ®çº¿ |
| ADDR         | I2Cåœ°å€é€‰æ‹©ï¼ˆæ¥åœ°é»˜è®¤0x33ï¼Œæ¥VCCä¸º0x34ï¼‰ |

---

## æ–‡ä»¶è¯´æ˜
### 1. mlx90640.py
åŒ…å«ä¼ æ„Ÿå™¨é©±åŠ¨æ ¸å¿ƒç±»åŠè¾…åŠ©ç±»ï¼š

| ç±»/æ–¹æ³• | ç±»å‹ | åŠŸèƒ½æè¿° |
|---------|------|----------|
| `RefreshRate` | æšä¸¾ç±» | å®šä¹‰ä¼ æ„Ÿå™¨æ”¯æŒçš„åˆ·æ–°ç‡é€‰é¡¹ï¼ŒåŒ…æ‹¬0.5Hzã€1Hzã€2Hzç­‰å¤šç§é€Ÿç‡ |
| `I2CDevice` | é€šä¿¡ç±» | å°è£…I2Cé€šä¿¡åº•å±‚æ“ä½œ |
| `I2CDevice.write_then_read_into(write_buf, read_buf, *, out_start=0, out_end=None, in_start=0, in_end=None)` | å®ä¾‹æ–¹æ³• | å…ˆå‘ä¼ æ„Ÿå™¨å†™å…¥æ•°æ®ï¼ˆé€šå¸¸ä¸ºå¯„å­˜å™¨åœ°å€ï¼‰ï¼Œå†ä»ä¼ æ„Ÿå™¨è¯»å–æ•°æ®åˆ°æŒ‡å®šç¼“å†²åŒºï¼›é€šè¿‡memoryviewä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼ŒéISR-safe |
| `I2CDevice.write(buf, *, start=0, end=None)` | å®ä¾‹æ–¹æ³• | å‘ä¼ æ„Ÿå™¨å†™å…¥ç¼“å†²åŒºæ•°æ®ï¼›è°ƒç”¨machine.I2C.writetoå®ç°ï¼Œè¦æ±‚bufä¸ºbytesæˆ–bytearrayç±»å‹ï¼Œå†™å…¥å¤±è´¥æŠ›å‡ºOSErrorï¼ŒéISR-safe |
| `MLX90640` | ä¼ æ„Ÿå™¨ç±» | å°è£…MLX90640ä¼ æ„Ÿå™¨çš„é«˜å±‚æ“ä½œæ¥å£ï¼ˆåˆå§‹åŒ–ã€æ¸©åº¦è¯»å–ã€åˆ·æ–°ç‡è®¾ç½®ç­‰ï¼‰ |
| `MLX90640.__init__(i2c_device, address=0x33)` | æ„é€ æ–¹æ³• | åˆå§‹åŒ–ä¼ æ„Ÿå™¨å®ä¾‹ï¼Œå»ºç«‹ä¸I2Cè®¾å¤‡çš„è¿æ¥ |
| `MLX90640.init()` | å®ä¾‹æ–¹æ³• | åˆå§‹åŒ–ä¼ æ„Ÿå™¨ï¼ŒåŠ è½½æ ¡å‡†æ•°æ® |
| `MLX90640.get_frame()` | å®ä¾‹æ–¹æ³• | è¯»å–ä¸€å¸§æ¸©åº¦æ•°æ®ï¼ˆ24Ã—32ç‚¹é˜µï¼‰ï¼Œè¿”å›æ¸©åº¦å€¼æ•°ç»„ |
| `MLX90640.set_refresh_rate(rate)` | å®ä¾‹æ–¹æ³• | è®¾ç½®ä¼ æ„Ÿå™¨æ•°æ®åˆ·æ–°ç‡ï¼Œå‚æ•°ä¸ºRefreshRateæšä¸¾å€¼ |

### 2. main.py
æµ‹è¯•ä¸»ç¨‹åºï¼Œæ— è‡ªå®šä¹‰ç±»ï¼Œæ ¸å¿ƒåŠŸèƒ½é€šè¿‡å‡½æ•°å®ç°ï¼š
- åˆå§‹åŒ–I2Cæ€»çº¿å’Œä¼ æ„Ÿå™¨å®ä¾‹
- é…ç½®ä¼ æ„Ÿå™¨åˆ·æ–°ç‡
- å¾ªç¯è¯»å–æ¸©åº¦æ•°æ®å¹¶è¾“å‡ºç»Ÿè®¡ä¿¡æ¯ï¼ˆæœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼ï¼‰
- æ‰“å°å±€éƒ¨åŒºåŸŸï¼ˆå¦‚å·¦ä¸Šè§’4Ã—4ï¼‰æ¸©åº¦åˆ†å¸ƒ

---

## è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³
### åˆ†å±‚è®¾è®¡
- åº•å±‚ï¼š`I2CDevice`ç±»å°è£…I2Cé€šä¿¡åè®®ï¼Œæä¾›åŸºç¡€è¯»å†™æ“ä½œ
- ä¸­å±‚ï¼š`MLX90640`ç±»å®ç°ä¼ æ„Ÿå™¨ç‰¹å®šå‘½ä»¤è§£æä¸æ•°æ®è½¬æ¢
- é«˜å±‚ï¼š`main.py`å®ç°åº”ç”¨çº§åŠŸèƒ½ï¼Œå¦‚æ•°æ®å±•ç¤ºä¸ç»Ÿè®¡

### æ•°æ®å¤„ç†ä¼˜åŒ–
- é‡‡ç”¨ç¼“å†²åŒºæ“ä½œå‡å°‘å†…å­˜åˆ†é…ï¼Œæé«˜å¤„ç†æ•ˆç‡
- æ¸©åº¦æ•°æ®è½¬æ¢ç®—æ³•åŸºäºä¼ æ„Ÿå™¨ datasheet å®ç°ï¼Œç¡®ä¿æµ‹é‡ç²¾åº¦

### è·¨å¹³å°å…¼å®¹
- ä»…ä¾èµ–MicroPythonæ ‡å‡†åº“ï¼ˆmachine.I2Cã€timeï¼‰
- ç¡¬ä»¶æ¥å£å‚æ•°åŒ–ï¼Œé€‚é…ä¸åŒå¼€å‘æ¿çš„I2Cå¼•è„šé…ç½®

---

## ä½¿ç”¨è¯´æ˜
### ç¡¬ä»¶æ¥çº¿ï¼ˆæ ‘è“æ´¾picoç¤ºä¾‹ï¼‰

| MLX90640å¼•è„š | GPIOå¼•è„š        |
|--------------|---------------|
| VCC          | 3.3V          |
| GND          | GND           |
| SCL          | GPIO1         |
| SDA          | GPIO0         |
| ADDR         | GNDï¼ˆé»˜è®¤åœ°å€0x33ï¼‰ |

> **æ³¨æ„**ï¼š
> - ä¼ æ„Ÿå™¨å¿…é¡»ä½¿ç”¨3.3Vä¾›ç”µï¼Œæ¥5Vä¼šæŸåèŠ¯ç‰‡
> - æ¥çº¿æ—¶ç¡®ä¿I2Cå¼•è„šä¸å¼€å‘æ¿é…ç½®ä¸€è‡´

### è½¯ä»¶ä¾èµ–
- **å›ºä»¶ç‰ˆæœ¬**ï¼šMicroPython v1.23.0åŠä»¥ä¸Š
- **å†…ç½®åº“**ï¼š
  - `machine`ï¼ˆI2Cæ€»çº¿ä¸GPIOæ§åˆ¶ï¼‰
  - `time`ï¼ˆå»¶æ—¶åŠŸèƒ½ï¼‰

### å®‰è£…æ­¥éª¤
1. å°†MicroPythonå›ºä»¶çƒ§å½•åˆ°å¼€å‘æ¿
2. ä¸Šä¼ `mlx90640.py`å’Œ`main.py`åˆ°å¼€å‘æ¿
3. æ ¹æ®ç¡¬ä»¶è¿æ¥ä¿®æ”¹`main.py`ä¸­çš„I2Cå¼•è„šé…ç½®
4. è¿è¡Œ`main.py`å¼€å§‹æµ‹è¯•

---

## ç¤ºä¾‹ç¨‹åº
```python
# Python env   : MicroPython v1.23.0
# -*- coding: utf-8 -*-
# @Time    : 2025/9/4 ä¸‹åˆ11:14
# @Author  : ç¼ªè´µæˆ
# @File    : main.py
# @Description :mlx90640ç‚¹é˜µçº¢å¤–æ¸©åº¦ä¼ æ„Ÿå™¨æ¨¡å—é©±åŠ¨æµ‹è¯•æ–‡ä»¶

# ======================================== å¯¼å…¥ç›¸å…³æ¨¡å— =========================================

from machine import I2C
import time
from mlx90640 import MLX90640, RefreshRate

# ======================================== å…¨å±€å˜é‡ ============================================

mlxaddr=None

# ======================================== åŠŸèƒ½å‡½æ•° ============================================

# ======================================== è‡ªå®šä¹‰ç±» ============================================

# ======================================== åˆå§‹åŒ–é…ç½® ===========================================

time.sleep(3)
print("FreakStudio:Testing the MLX90640 fractional infrared temperature sensor")
# Initialize I2C bus (adjust pins if needed)

i2c = I2C(0, scl=1, sda=0, freq=100000)

# å¼€å§‹æ‰«æI2Cæ€»çº¿ä¸Šçš„è®¾å¤‡ï¼Œè¿”å›ä»æœºåœ°å€çš„åˆ—è¡¨
devices_list: list[int] = i2c.scan()
print('START I2C SCANNER')
# è‹¥devices listä¸ºç©ºï¼Œåˆ™æ²¡æœ‰è®¾å¤‡è¿æ¥åˆ°I2Cæ€»çº¿ä¸Š
if len(devices_list) == 0:
    # è‹¥éç©ºï¼Œåˆ™æ‰“å°ä»æœºè®¾å¤‡åœ°å€
    print("No i2c device !")
else:
    print('i2c devices found:', len(devices_list))
for device in devices_list:
    if 0x31 <= device <= 0x35:
        print("I2c hexadecimal address:", hex(device))
        mlxaddr = device

# Initialize MLX90640
try:
    thermal_camera = MLX90640(i2c, mlxaddr)
    print("MLX90640 sensor initialized successfully")
except ValueError as init_error:
    print(f"Sensor initialization failed: {init_error}")
    raise SystemExit(1)
# Show sensor info
print(f"Device serial number: {thermal_camera.serial_number}")
# Set refresh rate
try:
    thermal_camera.refresh_rate = RefreshRate.REFRESH_2_HZ
    print(f"Refresh rate set to {thermal_camera.refresh_rate} Hz")
except ValueError as rate_error:
    print(f"Failed to set refresh rate: {rate_error}")
    raise SystemExit(1)
# æ¯”å¦‚æµ‹äººä½“æ—¶å€™å‘å°„ç‡
thermal_camera.emissivity = 0.92
# Prepare temperature data buffer
temperature_frame = [0.0] * 768

# ========================================  ä¸»ç¨‹åº  ============================================

# Main measurement loop
try:
    while True:
        try:
            thermal_camera.get_frame(temperature_frame)
        except RuntimeError as read_error:
            print(f"Frame acquisition failed: {read_error}")
            time.sleep(0.5)
            continue

        # Statistics
        min_temp = min(temperature_frame)
        max_temp = max(temperature_frame)
        avg_temp = sum(temperature_frame) / len(temperature_frame)

        print("\n--- Temperature Statistics ---")
        print(f"Min: {min_temp:.2f} Â°C | Max: {max_temp:.2f} Â°C | Avg: {avg_temp:.2f} Â°C")

        # Print a few pixels (top-left 4*4 area)
        print("--- Sample Pixels (Top-Left 4x4) ---")
        # æ‰“å°å·¦ä¸Šè§’4*4åƒç´ 
        for row in range(4):
            row_data = [
                # è¿™é‡Œrow*32å› ä¸ºä¸€è¡Œæ˜¯32ä¸ªåƒç´ ç‚¹ï¼Œæ‰€ä»¥è¿™ä¸ªrow*32è¡¨ç¤ºæ¯ä¸€è¡Œçš„ç´¢å¼•ï¼Œç¬¬0è¡Œç´¢å¼•æ˜¯0
                f"{temperature_frame[row*32 + col]:5.1f}"
                for col in range(4)
            ]
            print(" | ".join(row_data))

        # ç­‰å¾…ä¸‹ä¸€æ¬¡æµ‹é‡ï¼Œç”¨åˆ·æ–°ç‡ç¼–å·åŠ 1ä½œä¸ºè¿‘ä¼¼å€¼æ¥è®¡ç®—ï¼Œé˜²æ­¢è¯»å–æ•°æ®è¿‡å¿«
        time.sleep(1.0 / (thermal_camera.refresh_rate + 1))

except KeyboardInterrupt:
    print("\nProgram terminated by user")
finally:
    print("Testing process completed")


```
---

## æ³¨æ„äº‹é¡¹
- ä¼ æ„Ÿå™¨åˆå§‹åŒ–å¤±è´¥æ—¶ï¼Œæ£€æŸ¥I2Cåœ°å€æ˜¯å¦æ­£ç¡®ï¼ˆé»˜è®¤0x33ï¼ŒADDRå¼•è„šæ¥VCCæ—¶ä¸º0x34ï¼‰
- åˆ·æ–°ç‡è®¾ç½®è¿‡é«˜å¯èƒ½å¯¼è‡´æ•°æ®è¯»å–ä¸ç¨³å®šï¼Œå»ºè®®æ ¹æ®åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚é€Ÿç‡
- ä¼ æ„Ÿå™¨å·¥ä½œæ—¶ä¼šå‘çƒ­ï¼Œå¯èƒ½å½±å“æµ‹é‡ç²¾åº¦ï¼Œå»ºè®®åšå¥½æ•£çƒ­æˆ–è¿›è¡Œæ¸©åº¦è¡¥å¿
- é¿å…åœ¨å¼ºç”µç£å¹²æ‰°ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œä»¥å…å½±å“I2Cé€šä¿¡ç¨³å®šæ€§
- æµ‹è¯•åˆ°çš„ç»“æœæœ€å°å€¼æ˜¾ç¤º273.15æ‘„æ°åº¦æ˜¯å› ä¸ºåƒç´ ç‚¹é‡Œé¢æœ‰åç‚¹æˆ–è€…å¤±æ•ˆåƒç´ ç‚¹ï¼Œä»£ç ä¸­å°†å¤±æ•ˆç‚¹æ ‡æ³¨ä¸º-273.15æ‘„æ°åº¦
---
## è”ç³»æ–¹å¼
å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»å¼€å‘è€…ï¼š  
ğŸ“§ **é‚®ç®±**ï¼š10696531183@qq.com  
ğŸ’» **GitHub**ï¼šhttps://github.com/FreakStudioCN

---

## è®¸å¯åè®®
æœ¬é¡¹ç›®ä¸­ï¼Œé™¤ `machine` ç­‰ MicroPython å®˜æ–¹æ¨¡å—ï¼ˆMIT è®¸å¯è¯ï¼‰å¤–ï¼Œæ‰€æœ‰ç”±ä½œè€…ç¼–å†™çš„é©±åŠ¨ä¸æ‰©å±•ä»£ç å‡é‡‡ç”¨ **çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…ç‰ˆ (CC BY-NC 4.0)** è®¸å¯åè®®å‘å¸ƒã€‚  

æ‚¨å¯ä»¥è‡ªç”±åœ°ï¼š  
- **å…±äº«** â€” åœ¨ä»»ä½•åª’ä»‹ä»¥ä»»ä½•å½¢å¼å¤åˆ¶ã€å‘è¡Œæœ¬ä½œå“  
- **æ¼”ç»** â€” ä¿®æ”¹ã€è½¬æ¢æˆ–ä»¥æœ¬ä½œå“ä¸ºåŸºç¡€è¿›è¡Œåˆ›ä½œ  

æƒŸé¡»éµå®ˆä¸‹åˆ—æ¡ä»¶ï¼š  
- **ç½²å** â€” æ‚¨å¿…é¡»ç»™å‡ºé€‚å½“çš„ç½²åï¼Œæä¾›æŒ‡å‘æœ¬è®¸å¯åè®®çš„é“¾æ¥ï¼ŒåŒæ—¶æ ‡æ˜æ˜¯å¦ï¼ˆå¯¹åŸå§‹ä½œå“ï¼‰ä½œäº†ä¿®æ”¹ã€‚æ‚¨å¯ä»¥ç”¨ä»»ä½•åˆç†çš„æ–¹å¼æ¥ç½²åï¼Œä½†æ˜¯ä¸å¾—ä»¥ä»»ä½•æ–¹å¼æš—ç¤ºè®¸å¯äººä¸ºæ‚¨æˆ–æ‚¨çš„ä½¿ç”¨èƒŒä¹¦ã€‚  
- **éå•†ä¸šæ€§ä½¿ç”¨** â€” æ‚¨ä¸å¾—å°†æœ¬ä½œå“ç”¨äºå•†ä¸šç›®çš„ã€‚  
- **åˆç†å¼•ç”¨æ–¹å¼** â€” å¯åœ¨ä»£ç æ³¨é‡Šã€æ–‡æ¡£ã€æ¼”ç¤ºè§†é¢‘æˆ–é¡¹ç›®è¯´æ˜ä¸­æ˜ç¡®æ¥æºã€‚  
- **è¯´æ˜** â€” ä»£ç å«å‚è€ƒéƒ¨åˆ†,å‡ºç°éæŠ€æœ¯é—®é¢˜å’Œç½²åä½œè€…æ— å…³ã€‚  
**ç‰ˆæƒå½’ FreakStudio æ‰€æœ‰ã€‚**