# GraftSense TCR5000L å•è·¯å¾ªè¿¹æ¨¡å— ï¼ˆMicroPythonï¼‰

# GraftSense TCR5000L å•è·¯å¾ªè¿¹æ¨¡å—é©±åŠ¨ ï¼ˆMicroPythonï¼‰

## ç›®å½•

- [ç®€ä»‹](#ç®€ä»‹)
- [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
- [ç¡¬ä»¶è¦æ±‚](#ç¡¬ä»¶è¦æ±‚)
- [æ–‡ä»¶è¯´æ˜](#æ–‡ä»¶è¯´æ˜)
- [è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³](#è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³)
- [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
- [ç¤ºä¾‹ç¨‹åº](#ç¤ºä¾‹ç¨‹åº)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
- [è”ç³»æ–¹å¼](#è”ç³»æ–¹å¼)
- [è®¸å¯åè®®](#è®¸å¯åè®®)

---

## ç®€ä»‹

æœ¬é¡¹ç›®ä¸º **GraftSense TCR5000L-based Single-line Tracking Module V1.0** æä¾›äº†å®Œæ•´çš„ MicroPython é©±åŠ¨æ”¯æŒï¼ŒåŸºäº TCR5000L çº¢å¤–åå°„ä¼ æ„Ÿå™¨å®ç°å•è·¯çº¿è·¯è·Ÿè¸ªæ£€æµ‹ã€‚æ¨¡å—é€šè¿‡çº¢å¤–å‘å°„ä¸æ¥æ”¶åˆ¤æ–­åœ°é¢é¢œè‰²ï¼ˆé»‘çº¿ / ç™½åº•ï¼‰ï¼Œè¾“å‡ºæ•°å­—ç”µå¹³ä¿¡å·ï¼Œæ”¯æŒçµæ•åº¦è°ƒèŠ‚ï¼ˆæ¿è½½ 10kÎ© ç”µä½å™¨ï¼‰ï¼Œé€‚ç”¨äºç”µå­ DIY å¾ªè¿¹å°è½¦å®éªŒã€æœºå™¨äººå¯¼èˆªæ¼”ç¤ºã€æ™ºèƒ½æ§åˆ¶é¡¹ç›®ç­‰åœºæ™¯ï¼Œå…·æœ‰å“åº”çµæ•ã€æ£€æµ‹å‡†ç¡®ã€ç»“æ„ç®€å•çš„ä¼˜åŠ¿ï¼Œéµå¾ª Grove æ¥å£æ ‡å‡†ã€‚

---

## ä¸»è¦åŠŸèƒ½

- âœ… æ•°å­—ç”µå¹³è¾“å‡ºï¼šé€šè¿‡ DIN å¼•è„šè¾“å‡ºé«˜ä½ç”µå¹³ï¼Œ0 è¡¨ç¤ºæ£€æµ‹åˆ°é»‘çº¿ï¼Œ1 è¡¨ç¤ºæ£€æµ‹åˆ°ç™½åº•
- âœ… çµæ•åº¦å¯è°ƒï¼šæ¿è½½ 10kÎ© ç”µä½å™¨ï¼ˆR5ï¼‰ï¼Œå¯è°ƒèŠ‚çº¢å¤–åå°„æ£€æµ‹é˜ˆå€¼ï¼Œé€‚é…ä¸åŒåœ°é¢æè´¨
- âœ… ä¸­æ–­é©±åŠ¨æ£€æµ‹ï¼šæ”¯æŒç”µå¹³å˜åŒ–ä¸­æ–­ï¼ˆä¸Šå‡æ²¿ / ä¸‹é™æ²¿è§¦å‘ï¼‰ï¼Œé¿å…è½®è¯¢å ç”¨ CPU
- âœ… å›è°ƒæœºåˆ¶ï¼šç”µå¹³å˜åŒ–æ—¶è‡ªåŠ¨è°ƒåº¦ç”¨æˆ·å›è°ƒå‡½æ•°ï¼Œæ”¯æŒå®æ—¶å“åº”æ£€æµ‹ç»“æœ
- âœ… è½»é‡çº§è¯»å–ï¼š`read()` æ–¹æ³•å¼€é”€æå°ï¼Œå¯åœ¨ä¸»å¾ªç¯ä¸­é¢‘ç¹è°ƒç”¨è·å–å½“å‰çŠ¶æ€
- âœ… èµ„æºç®¡ç†ï¼šæä¾› `deinit()` æ–¹æ³•ï¼Œæ³¨é”€ä¸­æ–­å¹¶é‡Šæ”¾ç¡¬ä»¶èµ„æºï¼Œé¿å…èµ„æºæ³„æ¼

---

## ç¡¬ä»¶è¦æ±‚

1. **æ ¸å¿ƒç¡¬ä»¶**ï¼šGraftSense TCR5000L-based Single-line Tracking Module V1.0ï¼ˆåŸºäº TCR5000L çº¢å¤–ä¼ æ„Ÿå™¨ï¼Œå†…ç½® DC-DC 5V è½¬ 3.3V ç”µè·¯ï¼‰
2. **ä¸»æ§è®¾å¤‡**ï¼šæ”¯æŒ MicroPython v1.23.0 åŠä»¥ä¸Šç‰ˆæœ¬çš„å¼€å‘æ¿ï¼ˆå¦‚æ ‘è“æ´¾ Picoã€ESP32 ç­‰ï¼‰
3. **æ¥çº¿é…ä»¶**ï¼šGrove 4Pin çº¿æˆ–æœé‚¦çº¿ï¼Œç”¨äºè¿æ¥æ¨¡å—çš„ DINã€GNDã€VCC å¼•è„š
4. **ç”µæº**ï¼š3.3V~5V ç¨³å®šç”µæºï¼ˆæ¨¡å—å†…ç½®ç”µå¹³è½¬æ¢ç”µè·¯ï¼Œå…¼å®¹ä¸¤ç§ä¾›ç”µæ–¹å¼ï¼‰

---

## æ–‡ä»¶è¯´æ˜

è¡¨æ ¼

---

## è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³

1. **ä¸­æ–­é©±åŠ¨æ¶æ„**ï¼šé€šè¿‡ GPIO ä¸­æ–­æ£€æµ‹ç”µå¹³å˜åŒ–ï¼Œæ›¿ä»£ä¼ ç»Ÿè½®è¯¢æ–¹å¼ï¼Œé™ä½ CPU å ç”¨ï¼Œæå‡å“åº”é€Ÿåº¦
2. **å›è°ƒå®‰å…¨è°ƒåº¦**ï¼šä½¿ç”¨ `micropython.schedule` å°†ç”¨æˆ·å›è°ƒå‡½æ•°è°ƒåº¦åˆ°ä¸»å¾ªç¯æ‰§è¡Œï¼Œé¿å…åœ¨ä¸­æ–­ä¸Šä¸‹æ–‡ï¼ˆISRï¼‰ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§
3. **èµ„æºç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šé€šè¿‡ `deinit()` æ–¹æ³•æ˜¾å¼æ³¨é”€ä¸­æ–­ã€é‡Šæ”¾ç¡¬ä»¶èµ„æºï¼Œé˜²æ­¢èµ„æºæ³„æ¼ï¼Œæ”¯æŒæ¨¡å—å¤ç”¨
4. **å‚æ•°æ ¡éªŒä¸å®¹é”™**ï¼šå¯¹å›è°ƒå‡½æ•°è¿›è¡Œå¯è°ƒç”¨æ€§æ ¡éªŒï¼Œé¿å…éæ³•å‚æ•°å¯¼è‡´ç¨‹åºå´©æºƒ
5. **è½»é‡çº§è®¾è®¡**ï¼šæ ¸å¿ƒè¯»å–æ–¹æ³• `read()` ä»…ç›´æ¥è¯»å–å¼•è„šç”µå¹³ï¼Œå¼€é”€æå°ï¼Œé€‚åˆé«˜é¢‘çŠ¶æ€æŸ¥è¯¢

---

## ä½¿ç”¨è¯´æ˜

### ç¯å¢ƒå‡†å¤‡

- åœ¨å¼€å‘æ¿ä¸Šçƒ§å½• **MicroPython v1.23.0+** å›ºä»¶
- å°† `tcr5000.py` å’Œ `main.py` ä¸Šä¼ è‡³å¼€å‘æ¿æ–‡ä»¶ç³»ç»Ÿ

### ç¡¬ä»¶è¿æ¥

- ä½¿ç”¨ Grove çº¿æˆ–æœé‚¦çº¿å°†æ¨¡å—çš„ **DIN** å¼•è„šè¿æ¥è‡³å¼€å‘æ¿æŒ‡å®š GPIO å¼•è„šï¼ˆå¦‚ç¤ºä¾‹ä¸­çš„ Pin 6ï¼‰
- è¿æ¥ `GND` å’Œ `VCC` å¼•è„šï¼Œç¡®ä¿ 3.3V~5V ä¾›ç”µç¨³å®š
- è°ƒèŠ‚æ¿è½½ 10kÎ© ç”µä½å™¨ï¼ˆR5ï¼‰ï¼šé»˜è®¤è¾“å‡ºé«˜ç”µå¹³ï¼Œå½“æ£€æµ‹åˆ°é»‘çº¿æ—¶ DIN å¼•è„šç”µå¹³å˜ä¸ºä½ç”µå¹³ï¼Œå¯æ ¹æ®åœ°é¢åå°„æƒ…å†µå¾®è°ƒçµæ•åº¦

### ä»£ç é…ç½®

```python
from tcr5000 import TCR5000

# åˆå§‹åŒ–ä¼ æ„Ÿå™¨ï¼ˆDIN å¼•è„šä¸º 6ï¼Œä¸­æ–­è§¦å‘æ–¹å¼ä¸ºä¸Šå‡/ä¸‹é™æ²¿ï¼‰
sensor = TCR5000(pin=6)

# å®šä¹‰å›è°ƒå‡½æ•°ï¼ˆç”µå¹³å˜åŒ–æ—¶è§¦å‘ï¼‰
def on_change(value):
    print("Level changed to:", value)

# æ³¨å†Œå›è°ƒå‡½æ•°
sensor.set_callback(on_change)
```

### è¿è¡Œæµ‹è¯•

- é‡å¯å¼€å‘æ¿ï¼Œ`main.py` å°†è‡ªåŠ¨æ‰§è¡Œï¼š

  - å¾ªç¯æ‰“å°å½“å‰æ£€æµ‹ç”µå¹³ï¼ˆ1 ç§’ / æ¬¡ï¼‰
  - å½“ä¼ æ„Ÿå™¨æ£€æµ‹åˆ°é»‘çº¿ / ç™½åº•åˆ‡æ¢æ—¶ï¼Œè§¦å‘å›è°ƒå‡½æ•°æ‰“å°å˜åŒ–ä¿¡æ¯
- æŒ‰ä¸‹ `Ctrl+C` å¯ç»ˆæ­¢ç¨‹åºï¼Œè‡ªåŠ¨é‡Šæ”¾ä¸­æ–­èµ„æº

---

## ç¤ºä¾‹ç¨‹åº

```python
import time
from tcr5000 import TCR5000

def on_change(value: int) -> None:
    """ç”µå¹³å˜åŒ–å›è°ƒå‡½æ•°"""
    print("Callback triggered, value =", value)

# ä¸Šç”µå»¶æ—¶
time.sleep(3)
print("FreakStudio:Single-channel tracking module test")

# åˆå§‹åŒ–ä¼ æ„Ÿå™¨
sensor = TCR5000(pin=6)
# æ³¨å†Œå›è°ƒ
sensor.set_callback(on_change)

try:
    while True:
        # è¯»å–å½“å‰ç”µå¹³
        val = sensor.read()
        print("Current value:", val)
        time.sleep(1)

except KeyboardInterrupt:
    # é‡Šæ”¾èµ„æº
    sensor.deinit()
    print("Program interrupted, resources released.")
```

---

## æ³¨æ„äº‹é¡¹

1. **çµæ•åº¦è°ƒèŠ‚**ï¼šæ¿è½½ 10kÎ© ç”µä½å™¨ï¼ˆR5ï¼‰ç”¨äºè°ƒèŠ‚æ£€æµ‹é˜ˆå€¼ï¼Œé¡ºæ—¶é’ˆæ—‹è½¬å¯æé«˜çµæ•åº¦ï¼ˆæ›´å®¹æ˜“æ£€æµ‹åˆ°é»‘çº¿ï¼‰ï¼Œé€†æ—¶é’ˆæ—‹è½¬åˆ™é™ä½çµæ•åº¦ï¼Œéœ€æ ¹æ®å®é™…åœ°é¢æè´¨ï¼ˆå¦‚ç™½çº¸ã€é»‘èƒ¶å¸¦ï¼‰å¾®è°ƒ
2. **ç”µå¹³å«ä¹‰**ï¼šæ¨¡å—é»˜è®¤è®¾è®¡ä¸º â€œç™½åº•è¾“å‡ºé«˜ç”µå¹³ï¼ˆ1ï¼‰ï¼Œé»‘çº¿è¾“å‡ºä½ç”µå¹³ï¼ˆ0ï¼‰â€ï¼Œè‹¥éœ€åå‘é€»è¾‘ï¼Œå¯é€šè¿‡ç¡¬ä»¶æˆ–è½¯ä»¶åè½¬å¤„ç†
3. **ä¸­æ–­å®‰å…¨**ï¼šå›è°ƒå‡½æ•°é€šè¿‡ `micropython.schedule` è°ƒåº¦åˆ°ä¸»å¾ªç¯æ‰§è¡Œï¼Œé¿å…åœ¨ ISR ä¸­æ‰§è¡Œä¸²å£æ‰“å°ã€ç”µæœºæ§åˆ¶ç­‰è€—æ—¶æ“ä½œ
4. **èµ„æºé‡Šæ”¾**ï¼šç¨‹åºç»ˆæ­¢å‰éœ€è°ƒç”¨ `deinit()` æ³¨é”€ä¸­æ–­ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´åç»­ç¡¬ä»¶æ“ä½œå¼‚å¸¸
5. **ç¯å¢ƒå¹²æ‰°**ï¼šå¼ºå…‰ç›´å°„ã€åœ°é¢åå…‰ï¼ˆå¦‚ glossy æè´¨ï¼‰å¯èƒ½å½±å“çº¢å¤–æ£€æµ‹ç²¾åº¦ï¼Œå»ºè®®åœ¨å®¤å†…æˆ–å¼±å…‰ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œæˆ–é€šè¿‡é®æŒ¡çº¢å¤–å‘å°„ç®¡å‡å°‘å¹²æ‰°
6. **ç”µæºå…¼å®¹**ï¼šæ¨¡å—å†…ç½® DC-DC 5V è½¬ 3.3V ç”µè·¯ï¼Œå¯ç›´æ¥è¿æ¥ 5V ä¸»æ§å¼•è„šï¼Œæ— éœ€é¢å¤–ç”µå¹³è½¬æ¢

---

## è”ç³»æ–¹å¼

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»å¼€å‘è€…ï¼šğŸ“§ **é‚®ç®±**ï¼šliqinghsui@freakstudio.cnğŸ’» **GitHub**ï¼š[https://github.com/FreakStudioCN](https://github.com/FreakStudioCN)

---

## è®¸å¯åè®®

æœ¬é¡¹ç›®é‡‡ç”¨ **MIT License** å¼€æºåè®®ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š

```
MIT License

Copyright (c) 2025 FreakStudio

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```
