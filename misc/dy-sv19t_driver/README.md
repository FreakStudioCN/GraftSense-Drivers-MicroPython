# DY-SV19T è¯­éŸ³æ’­æ”¾æ¨¡å—é©±åŠ¨ - MicroPythonç‰ˆæœ¬

## ç›®å½•
- [ç®€ä»‹](#ç®€ä»‹)
- [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
- [ç¡¬ä»¶è¦æ±‚](#ç¡¬ä»¶è¦æ±‚)
- [æ–‡ä»¶è¯´æ˜](#æ–‡ä»¶è¯´æ˜)
- [è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³](#è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³)
- [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
- [ç¤ºä¾‹ç¨‹åº](#ç¤ºä¾‹ç¨‹åº)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
- [è”ç³»æ–¹å¼](#è”ç³»æ–¹å¼)
- [è®¸å¯åè®®](#è®¸å¯åè®®)

---

## ç®€ä»‹
DY-SV19T æ˜¯ä¸€æ¬¾æ”¯æŒ UART ä¸²å£æ§åˆ¶çš„è¯­éŸ³æ’­æ”¾æ¨¡å—ï¼Œå¹¿æ³›åº”ç”¨äºè¯­éŸ³æç¤ºã€æ™ºèƒ½ç¡¬ä»¶ã€æœºå™¨äººç­‰åœºæ™¯ã€‚é©±åŠ¨æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€æš‚åœã€åœæ­¢ã€éŸ³é‡è°ƒèŠ‚ã€EQã€å¾ªç¯æ¨¡å¼ã€æ’æ’­ã€ç»„åˆæ’­æ”¾ç­‰ä¸°å¯ŒåŠŸèƒ½ï¼Œä¾¿äºå¼€å‘è€…å¿«é€Ÿé›†æˆåˆ° MicroPython é¡¹ç›®ã€‚

---

## ä¸»è¦åŠŸèƒ½
- **éŸ³é¢‘æ’­æ”¾æ§åˆ¶**ï¼šæ”¯æŒæ’­æ”¾ã€æš‚åœã€åœæ­¢ã€ä¸Šä¸€é¦–ã€ä¸‹ä¸€é¦–
- **éŸ³é‡ä¸å‡è¡¡è°ƒèŠ‚**ï¼šéŸ³é‡ 0~30ï¼ŒEQ å¤šç§æ¨¡å¼
- **å¾ªç¯ä¸éšæœºæ’­æ”¾**ï¼šå¤šç§å¾ªç¯/é¡ºåº/éšæœºæ¨¡å¼
- **æŒ‡å®šæ›²ç›®/è·¯å¾„æ’­æ”¾**ï¼šæ”¯æŒæŒ‰æ›²ç›®å·æˆ–è·¯å¾„æ’­æ”¾ã€æ’æ’­
- **ç»„åˆæ’­æ”¾**ï¼šæ”¯æŒ ZH æ–‡ä»¶å¤¹ä¸‹å¤šæ›²ç›®ç»„åˆæ’­æ”¾
- **æ’­æ”¾è¿›åº¦æŸ¥è¯¢**ï¼šæ”¯æŒè‡ªåŠ¨ä¸ŠæŠ¥ä¸ä¸»åŠ¨æŸ¥è¯¢æ’­æ”¾æ—¶é—´
- **çŠ¶æ€ä¸ä¿¡æ¯æŸ¥è¯¢**ï¼šç›˜ç¬¦ã€æ›²ç›®ã€æ–‡ä»¶å¤¹ã€çŸ­æ–‡ä»¶åç­‰
- **å‚æ•°æ ¡éªŒä¸å¼‚å¸¸å¤„ç†**ï¼šæ¥å£å‚æ•°ä¸¥æ ¼æ ¡éªŒï¼Œé”™è¯¯æç¤ºæ¸…æ™°

---

## ç¡¬ä»¶è¦æ±‚
### æ¨èæµ‹è¯•ç¡¬ä»¶
- æ ‘è“æ´¾ Pico/Pico W
- DY-SV19T è¯­éŸ³æ’­æ”¾æ¨¡å—
- æœé‚¦çº¿è‹¥å¹²

### æ¨¡å—å¼•è„šè¯´æ˜
| DY-SV19T å¼•è„š | åŠŸèƒ½æè¿° |
|--------------|----------|
| VCC          | ç”µæºæ­£æï¼ˆ3.3V/5Vï¼‰ |
| GND          | ç”µæºè´Ÿæ |
| TX           | ä¸²å£è¾“å‡ºï¼ˆæ¥å¼€å‘æ¿ RXï¼‰ |
| RX           | ä¸²å£è¾“å…¥ï¼ˆæ¥å¼€å‘æ¿ TXï¼‰ |

---

## æ–‡ä»¶è¯´æ˜
### dy_sv19t.py
é©±åŠ¨æ ¸å¿ƒï¼ŒåŒ…å« DYSV19T ç±»åŠæ‰€æœ‰æ§åˆ¶/æŸ¥è¯¢æ–¹æ³•ã€‚
```python
class DS1232:
    """
    è¯¥ç±»æ§åˆ¶å¤–éƒ¨ DS1232 çœ‹é—¨ç‹—æ¨¡å—ï¼Œé€šè¿‡å‘¨æœŸæ€§ç¿»è½¬ WDI å¼•è„šå–‚ç‹—ï¼Œé¿å… MCU è¢«å¤ä½ã€‚

    Attributes:
        wdi (Pin): machine.Pin å®ä¾‹ï¼Œç”¨äºè¾“å‡ºå–‚ç‹—è„‰å†²ã€‚
        state (int): å½“å‰ WDI å¼•è„šè¾“å‡ºçŠ¶æ€ï¼Œ0 æˆ– 1ã€‚
        timer (Timer): machine.Timer å®ä¾‹ï¼Œç”¨äºå‘¨æœŸæ€§å–‚ç‹—ã€‚

    Methods:
        __init__(wdi_pin: int, feed_interval: int = 1000) -> None: åˆå§‹åŒ–çœ‹é—¨ç‹—å¹¶å¯åŠ¨å®šæ—¶å–‚ç‹—ã€‚
        stop() -> None: åœæ­¢è‡ªåŠ¨å–‚ç‹—ï¼Œå°† WDI å¼•è„šç½®ä½ã€‚
        kick() -> None: æ‰‹åŠ¨å–‚ç‹—ï¼Œç«‹å³ç¿»è½¬ä¸€æ¬¡ WDI å¼•è„šã€‚

    Notes:
        åˆå§‹åŒ–æ—¶ä¼šåˆ›å»º Timer å¯¹è±¡ä»¥å®šæ—¶ç¿»è½¬ WDIã€‚
        _feed ä¸ºå†…éƒ¨å›è°ƒæ–¹æ³•ï¼Œä¸å»ºè®®ç›´æ¥è°ƒç”¨ã€‚
        è¯¥ç±»æ–¹æ³•å¤§å¤šé ISR-safeï¼ŒTimer å›è°ƒ _feed æ˜¯ ISR-safeã€‚
        stop() å WDI å¼•è„šä¿æŒä½ç”µå¹³ï¼ŒDS1232 å°†åœ¨è¶…æ—¶åå¤ä½ MCUã€‚

    ==========================================

    DS1232_Watchdog driver for controlling an external DS1232 watchdog module.
    Periodically toggles WDI pin to prevent MCU reset.

    Attributes:
        wdi (Pin): machine.Pin instance for feeding pulses.
        state (int): Current WDI output state, 0 or 1.
        timer (Timer): machine.Timer instance for periodic feeding.

    Methods:
        __init__(wdi_pin: int, feed_interval: int = 1000) -> None: Initialize the watchdog and start automatic feeding.
        stop() -> None: Stop automatic feeding and set WDI low.
        kick() -> None: Manually feed the watchdog by toggling WDI once.

    Notes:
        Initializes a Timer to periodically toggle WDI.
        _feed is an internal callback method, not recommended for direct user call.
        Most methods are not ISR-safe; _feed callback is ISR-safe.
        After stop(), WDI remains low; DS1232 will reset MCU on timeout.
    """

    def __init__(self, wdi_pin: int, feed_interval: int = 1000) -> None:
```
### main.py
ä¸»ç¨‹åºï¼Œæ¼”ç¤ºæ¨¡å—åˆå§‹åŒ–ã€æ’­æ”¾æ§åˆ¶ã€æŸ¥è¯¢ã€ç»„åˆæ’­æ”¾ç­‰åŠŸèƒ½ã€‚

---

## è½¯ä»¶è®¾è®¡æ ¸å¿ƒæ€æƒ³

### æ¨¡å—åŒ–è®¾è®¡
- é©±åŠ¨ä¸åº”ç”¨åˆ†ç¦»ï¼Œæ¥å£æ¸…æ™°
- æ‰€æœ‰å‘½ä»¤/æŸ¥è¯¢å‡ä¸ºæ–¹æ³•è°ƒç”¨ï¼Œå‚æ•°æ ¡éªŒä¸¥æ ¼

### ä¸²å£é€šä¿¡åè®®
- æ‰€æœ‰å‘½ä»¤å‡æŒ‰æ¨¡å—åè®®å¸§æ ¼å¼å‘é€
- å“åº”å¸§è‡ªåŠ¨è§£æä¸æ ¡éªŒï¼Œå¼‚å¸¸è‡ªåŠ¨å¤„ç†

### å‚æ•°ä¸é”™è¯¯å¤„ç†
- æ‰€æœ‰æ¥å£å‚æ•°ç±»å‹ä¸èŒƒå›´æ ¡éªŒ
- é”™è¯¯ä¿¡æ¯æ˜ç¡®ï¼Œä¾¿äºè°ƒè¯•

### å…¼å®¹æ€§ä¸æ‰©å±•æ€§
- ä»…ä¾èµ– MicroPython æ ‡å‡†åº“
- æ”¯æŒå¤šç§ç¡¬ä»¶å¹³å°

---

## ä½¿ç”¨è¯´æ˜

### ç¡¬ä»¶æ¥çº¿ï¼ˆæ ‘è“æ´¾ Pico ç¤ºä¾‹ï¼‰

| DY-SV19T å¼•è„š | Pico GPIO å¼•è„š |
|---------------|----------------|
| VCC           | 3.3V/5V        |
| GND           | GND            |
| TX            | GP1 (æ¥ RX)    |
| RX            | GP0 (æ¥ TX)    |

> **æ³¨æ„ï¼š**
> - ä¸²å£æ³¢ç‰¹ç‡éœ€è®¾ä¸º 9600 8N1
> - VCC æ”¯æŒ 3.3V æˆ– 5Vï¼Œå»ºè®®ä½¿ç”¨ç¨³å®šç”µæº

---

### è½¯ä»¶ä¾èµ–

- **å›ºä»¶ç‰ˆæœ¬**ï¼šMicroPython v1.19+
- **å†…ç½®åº“**ï¼š
  - `machine`ï¼ˆUARTã€Pinã€Timer æ§åˆ¶ï¼‰
  - `time`ï¼ˆå»¶æ—¶ä¸è®¡æ—¶ï¼‰
- **å¼€å‘å·¥å…·**ï¼šPyCharm æˆ– Thonnyï¼ˆæ¨èï¼‰

---

### å®‰è£…æ­¥éª¤

1. çƒ§å½• MicroPython å›ºä»¶åˆ°å¼€å‘æ¿
2. ä¸Šä¼  `dy_sv19t.py` å’Œ `main.py` åˆ°å¼€å‘æ¿
3. æ ¹æ®ç¡¬ä»¶è¿æ¥ä¿®æ”¹ `main.py` ä¸­çš„ UART é…ç½®
4. è¿è¡Œ `main.py`ï¼Œæµ‹è¯•è¯­éŸ³æ’­æ”¾åŠŸèƒ½

---

## ç¤ºä¾‹ç¨‹åº
```python
# Python env   : MicroPython v1.23.0
# -*- coding: utf-8 -*-
# @Time    : 2025/09/17 16:35
# @Author  : ä¾¯é’§ç€š
# @File    : main.py
# @Description : DY-SV19T ç¤ºä¾‹

from machine import UART, Pin, Timer
import time
from dy_sv19t import *

# åˆå§‹åŒ– UART
uart = UART(0, baudrate=9600, tx=Pin(0), rx=Pin(1))
player = DYSV19T(uart, default_volume=20)

# è®¾ç½®éŸ³é‡ã€EQã€å¾ªç¯æ¨¡å¼ã€è¾“å‡ºé€šé“
player.set_volume(20)
player.set_eq(player.EQ_ROCK)
player.set_play_mode(player.MODE_SINGLE_STOP)
player.set_dac_channel(player.CH_MP3)

# æ’­æ”¾æŒ‡å®šæ›²ç›®
player.select_track(1, play=True)

# æŸ¥è¯¢æ’­æ”¾çŠ¶æ€ä¸ä¿¡æ¯
print("çŠ¶æ€:", player.query_status())
print("å½“å‰ç›˜ç¬¦:", player.query_current_disk())
print("å½“å‰æ›²ç›®:", player.query_current_track())
print("æ€»æ›²ç›®æ•°:", player.query_total_tracks())
print("å½“å‰æ’­æ”¾æ—¶é—´:", player.query_current_track_time())
print("çŸ­æ–‡ä»¶å:", player.query_short_filename())

# ç»„åˆæ’­æ”¾ç¤ºä¾‹
player.start_combination_playlist(['01', '02', '03'])
time.sleep(5)
player.end_combination_playlist()
```

## æ³¨æ„äº‹é¡¹

**ä¸²å£é…ç½®**
- æ³¢ç‰¹ç‡éœ€ä¸º 9600ï¼Œæ•°æ®ä½ 8ï¼Œåœæ­¢ä½ 1ï¼Œæ— æ ¡éªŒ
- TX/RX æ¥çº¿éœ€ä¸å¼€å‘æ¿ä¸²å£å¯¹åº”

**éŸ³é¢‘æ–‡ä»¶è¦æ±‚**
- è·¯å¾„éœ€ä»¥ / èµ·å§‹ï¼Œæ–‡ä»¶å¤¹å 1~8 å­—èŠ‚ï¼Œä»…å…è®¸ A-Z/0-9/_
- æ–‡ä»¶åå»ºè®®é‡‡ç”¨ 8.3 æ ¼å¼ï¼Œæ”¯æŒ MP3/WAV

**ç”µæºè¦æ±‚**
- å»ºè®®ä½¿ç”¨ç¨³å®š 3.3V/5V ç”µæº
- å¤§åŠŸç‡å–‡å­å»ºè®®å•ç‹¬ä¾›ç”µ

**å…¶ä»–**
- æŸ¥è¯¢æ–¹æ³•è¶…æ—¶è¿”å› Noneï¼Œä¸æŠ›å¼‚å¸¸
- æ§åˆ¶æ–¹æ³•å†™ä¸²å£å¤±è´¥å¯èƒ½æŠ› IOError

**è”ç³»æ–¹å¼**
- å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘è€…ï¼š ğŸ“§ é‚®ç®±ï¼š10696531183@qq.com ğŸ’» GitHubï¼šhttps://github.com/FreakStudioCN/GraftSense-Drivers-MicroPython

**è®¸å¯åè®®**

æœ¬é¡¹ç›®é™¤ MicroPython å®˜æ–¹æ¨¡å—ï¼ˆMIT è®¸å¯è¯ï¼‰å¤–ï¼Œæ‰€æœ‰ç”±ä½œè€…ç¼–å†™çš„é©±åŠ¨ä¸æ‰©å±•ä»£ç å‡é‡‡ç”¨ çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…ç‰ˆ (CC BY-NC 4.0) è®¸å¯åè®®å‘å¸ƒã€‚
ç‰ˆæƒå½’ FreakStudio æ‰€æœ‰ã€‚