# 滑动变阻器驱动 - MicroPython版本
## 目录
- [简介](#简介)
- [主要功能](#主要功能)
- [硬件要求](#硬件要求)
- [文件说明](#文件说明)
- [软件设计核心思想](#软件设计核心思想)
- [使用说明](#使用说明)
- [示例程序](#示例程序)
- [注意事项](#注意事项)
- [联系方式](#联系方式)
- [许可协议](#许可协议)
---
## 简介
滑动变阻器是一种通过线性滑动触点改变接入电路电阻值的被动电子元件，基于分压原理输出随滑动位置变化的电压信号，广泛应用于亮度调节、音量控制、电机转速调节等场景。本项目提供基于MicroPython的驱动代码，封装ADC采样、电压转换、归一化比例计算功能，支持快速集成。

> **注意**：适用于线性滑动变阻器，不适用于精密电位器或数字电位器，不可用于高精度测量场景。
---
## 主要功能
- 读取ADC原始值（0~65535）、计算实际电压（0~参考电压）、输出归一化比例（0.0~1.0）
- 聚合返回完整状态数据，支持外部传入ADC实例适配不同硬件
- 兼容MicroPython主流开发板，接口简洁易用
---
## 硬件要求
### 推荐测试硬件
- MicroPython开发板（如树莓派Pico）、线性滑动变阻器（1KΩ~100KΩ）、杜邦线3根、（可选）面包板
### 模块引脚说明
| 滑动变阻器引脚 | 功能描述 | 连接说明 |
|--------------|----------|----------|
| 固定端1（左） | 电源输入 | 接开发板3.3V |
| 滑动触点（中间） | 信号输出 | 接开发板ADC引脚（如Pico的GP26/ADC0） |
| 固定端2（右） | 接地 | 接开发板GND |
---
## 文件说明
### potentiometer.py
该文件实现滑动变阻器的核心驱动功能，仅包含`Potentiometer`类，用于处理滑动变阻器的信号读取与数据转换。

`Potentiometer`类通过封装ADC采样逻辑，提供滑动变阻器的多维度数据访问接口。类中包含两个私有属性：`_adc`用于存储外部传入的ADC实例，负责采集滑动触点的分压信号；`_vref`为ADC参考电压（默认3.3V），用于电压值计算。

类的主要方法包括：
- `__init__(adc: ADC, vref: float = 3.3)`：初始化驱动对象，接收已配置的ADC实例和可选的参考电压参数，完成硬件接口绑定与参数配置。
- `read_raw() -> int`：读取ADC原始采样值（范围0~65535），直接返回滑动触点的电信号原始数据，不进行任何转换处理。
- `read_voltage() -> float`：基于分压原理计算实际电压值，通过原始ADC值与参考电压的比例关系（原始值/65535×参考电压）得出，单位为伏特（V）。
- `read_ratio() -> float`：将滑动位置转换为归一化比例（范围0.0~1.0），0对应滑动触点位于固定端1极限位置，1对应固定端2极限位置，直观反映物理滑动比例。
- `get_state() -> dict`：聚合返回滑动变阻器的完整状态数据，以字典形式包含raw（原始值）、voltage（电压值）、ratio（比例值）三个关键参数，方便一次获取多维度信息。
- `adc`（属性）：返回绑定的ADC实例，支持应用层直接操作ADC硬件（如调整采样精度）。
- `vref`（属性）：返回当前参考电压值，用于校准验证或日志输出。


### main.py
该文件为滑动变阻器的功能测试程序，无自定义类，仅包含`main`函数作为程序入口。

`main`函数的核心功能是：初始化与滑动变阻器连接的ADC引脚，创建`Potentiometer`驱动实例，通过循环调用`get_state()`方法实时读取滑动变阻器的状态数据并打印输出。程序支持通过`interval`参数（默认0.5秒）调整采样间隔，允许用户通过Ctrl+C手动终止测试，适用于验证滑动变阻器的硬件连接正确性和驱动功能完整性。
## 软件设计核心思想
- 模块化：拆分数据读取、电压转换、比例计算为独立方法，聚合调用易维护
- 分压适配：基于滑动变阻器分压原理设计，确保电压与比例计算准确
- 硬件解耦：ADC实例由应用层传入，驱动不负责硬件初始化，兼容不同开发板
---
## 使用说明
### 硬件接线（树莓派Pico示例）
| 滑动变阻器引脚 | Pico引脚 | 接线功能 |
|--------------|----------|----------|
| 固定端1 | 3.3V（Pin36） | 电源输入 |
| 滑动触点 | GP26/ADC0（Pin31） | 信号采样 |
| 固定端2 | GND（Pin38） | 接地 |
### 软件依赖
- 固件：MicroPython v1.23+；内置库：`machine`（ADC控制）、`time`（延时）；开发工具：Thonny/PyCharm
### 安装步骤
1. 烧录MicroPython固件到开发板
2. 上传`potentiometer.py`和`main.py`，修改`main.py`中`ADC(0)`为实际接线引脚
3. 运行`main.py`，滑动触点观察数值变化
---
## 示例程序
```python
# Python env   : MicroPython v1.23.0
# -*- coding: utf-8 -*-
# @Time    : 2025/8/28 下午3:19
# @Author  : 缪贵成
# @File    : main.py
# @Description : 滑动变阻器测试文件

# ======================================== 导入相关模块 =========================================

import time
from machine import ADC
from potentiometer import Potentiometer

# ======================================== 全局变量 ============================================

# ======================================== 功能函数 ============================================

# ======================================== 自定义类 ============================================


# ======================================== 初始化配置 ===========================================

time.sleep(3)
print("FreakStudio:Sliding rheostat module testing")
# 滑动变阻器电压输出端接在 ADC0
adc = ADC(26)
pot = Potentiometer(adc)

# ========================================  主程序  ============================================

interval = 0.5
try:
    while True:
        # 获取当前状态字典
        state = pot.get_state()
        # 打印当前状态
        print(f"State: raw={state['raw']}, voltage={state['voltage']:.3f} V, ratio={state['ratio']:.3f}")
        # 等待下一次读取
        time.sleep(interval)

except KeyboardInterrupt:
    print("\nTest terminated by user.")


```
---
## 注意事项
### 电气特性限制
- **电压限制**：ADC 输入电压严禁超过参考电压（默认 3.3V），否则会烧毁 ADC 模块；滑动变阻器固定端 1 必须接与参考电压匹配的电源（如 3.3V）
- **阻值选择**：滑动变阻器阻值推荐 1KΩ~100KΩ，阻值过小（<1KΩ）会导致固定端 1 和 2 之间电流过大，可能烧毁电源；阻值过大（>100KΩ）会导致 ADC 采样信号弱，易受干扰
- **触点磨损**：机械滑动触点存在寿命限制（通常 10 万～100 万次滑动），高频滑动场景建议选择无触点式滑动传感器（如电容式）

### 硬件接线与配置注意事项
- **共地要求**：滑动变阻器 GND 必须与开发板 GND 可靠连接，否则分压信号会因电平漂移导致读数异常（如数值跳变）
- **接线可靠性**：滑动变阻器引脚较细，面包板测试时需确保引脚完全插入插孔，避免虚接导致的数值波动；长期使用建议焊接端子
- **ADC 引脚选择**：确认开发板的 ADC 引脚（如 Pico 的 GP26~GP28 为 ADC 引脚），不可将普通 GPIO 引脚作为 ADC 输入
- **干扰防护**：ADC 信号线（滑动触点到 ADC 引脚）需短而粗，远离电机、继电器等强电磁干扰源，必要时使用屏蔽线

### 环境影响
- **温度限制**：滑动变阻器最佳工作温度为 -10℃~60℃，高温环境（>60℃）会加速电阻体老化，缩短使用寿命，严重时可能导致电阻值漂移超出正常范围；低温环境（<-10℃）会使滑动触点与电阻体之间的接触电阻增大，甚至出现触点接触不良，导致读数跳变或无响应。
- **湿度限制**：高湿环境（相对湿度 >85% RH）中，空气中的水汽易渗透到滑动变阻器内部，导致电阻体受潮锈蚀、引脚氧化，进而引发阻值漂移、接触不良等问题；需为滑动变阻器添加防潮外壳或涂抹防潮涂层，避免直接暴露在高湿环境中。
- **粉尘防护**：长期暴露在粉尘环境下，粉尘会堆积在滑动触点与电阻体的接触面上，增大接触电阻，导致读数精度下降、数值波动；同时粉尘可能进入滑动机构内部，阻碍触点正常滑动。建议每 3~6 个月用压缩气罐（气压 ≤0.3MPa）从电阻体两端向中间吹气，清除堆积的粉尘，严禁拆解变阻器或用尖锐工具清理，防止损坏电阻体和触点。

---
### 联系方式
如有任何问题或需要帮助，请通过以下方式联系开发者：  
📧 **邮箱**：10696531183@qq.com  
💻 **GitHub**：[https://github.com/FreakStudioCN](https://github.com/FreakStudioCN)  

---
### 许可协议
本项目中，除 `machine` 等 MicroPython 官方模块（MIT 许可证）外，所有由作者编写的驱动与扩展代码均采用 **知识共享署名-非商业性使用 4.0 国际版 (MIT)** 许可协议发布。  

您可以自由地：  
- **共享** — 在任何媒介以任何形式复制、发行本作品  
- **演绎** — 修改、转换或以本作品为基础进行创作  

惟须遵守下列条件：  
- **署名** — 您必须给出适当的署名，提供指向本许可协议的链接，同时标明是否（对原始作品）作了修改。您可以用任何合理的方式来署名，但是不得以任何方式暗示许可人为您或您的使用背书。  
- **非商业性使用** — 您不得将本作品用于商业目的。  
- **合理引用方式** — 可在代码注释、文档、演示视频或项目说明中明确来源。  

**版权归 FreakStudio 所有。**